_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[9],{"0W9y":function(t,e,n){"use strict";var r=n("J4zp"),o=n("TTt4");e.__esModule=!0,e.default=void 0;var i=o(n("BqPY")),a=n("TTnN"),c=n("a7Zl"),s=n("9DAu"),u={};function f(t,e,n,r){if(t&&(0,a.isLocalURL)(e)){t.prefetch(e,n,r).catch((function(t){0}));var o=r&&"undefined"!==typeof r.locale?r.locale:t&&t.locale;u[e+"%"+n+(o?"%"+o:"")]=!0}}var h=function(t){var e=!1!==t.prefetch,n=(0,c.useRouter)(),o=n&&n.pathname||"/",h=i.default.useMemo((function(){var e=(0,a.resolveHref)(o,t.href,!0),n=r(e,2),i=n[0],c=n[1];return{href:i,as:t.as?(0,a.resolveHref)(o,t.as):c||i}}),[o,t.href,t.as]),p=h.href,l=h.as,d=t.children,v=t.replace,m=t.shallow,b=t.scroll,g=t.locale;"string"===typeof d&&(d=i.default.createElement("a",null,d));var y=i.Children.only(d),w=y&&"object"===typeof y&&y.ref,_=(0,s.useIntersection)({rootMargin:"200px"}),x=r(_,2),P=x[0],O=x[1],E=i.default.useCallback((function(t){P(t),w&&("function"===typeof w?w(t):"object"===typeof w&&(w.current=t))}),[w,P]);(0,i.useEffect)((function(){var t=O&&e&&(0,a.isLocalURL)(p),r="undefined"!==typeof g?g:n&&n.locale,o=u[p+"%"+l+(r?"%"+r:"")];t&&!o&&f(n,p,l,{locale:r})}),[l,p,O,g,e,n]);var j={ref:E,onClick:function(t){y.props&&"function"===typeof y.props.onClick&&y.props.onClick(t),t.defaultPrevented||function(t,e,n,r,o,i,c,s){("A"!==t.currentTarget.nodeName||!function(t){var e=t.currentTarget.target;return e&&"_self"!==e||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which}(t)&&(0,a.isLocalURL)(n))&&(t.preventDefault(),null==c&&(c=r.indexOf("#")<0),e[o?"replace":"push"](n,r,{shallow:i,locale:s,scroll:c}).then((function(t){t&&c&&document.body.focus()})))}(t,n,p,l,v,m,b,g)},onMouseEnter:function(t){(0,a.isLocalURL)(p)&&(y.props&&"function"===typeof y.props.onMouseEnter&&y.props.onMouseEnter(t),f(n,p,l,{priority:!0}))}};if(t.passHref||"a"===y.type&&!("href"in y.props)){var M="undefined"!==typeof g?g:n&&n.locale,T=n&&n.isLocaleDomain&&(0,a.getDomainLocale)(l,M,n&&n.locales,n&&n.domainLocales);j.href=T||(0,a.addBasePath)((0,a.addLocale)(l,M,n&&n.defaultLocale))}return i.default.cloneElement(y,j)};e.default=h},1:function(t,e){},2:function(t,e){},"2tVS":function(t,e,n){"use strict";(function(t){var r=n("fssf"),o=n("jsv+"),i=n("Ik3D");function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=s.prototype:(null===t&&(t=new s(e)),t.length=e),t}function s(t,e,n){if(!s.TYPED_ARRAY_SUPPORT&&!(this instanceof s))return new s(t,e,n);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);s.TYPED_ARRAY_SUPPORT?(t=e).__proto__=s.prototype:t=p(t,e);return t}(t,e,n,r):"string"===typeof e?function(t,e,n){"string"===typeof n&&""!==n||(n="utf8");if(!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),o=(t=c(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(s.isBuffer(e)){var n=0|l(e.length);return 0===(t=c(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||(r=e.length)!==r?c(t,0):p(t,e);if("Buffer"===e.type&&i(e.data))return p(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(f(e),t=c(t,e<0?0:0|l(e)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e){var n=e.length<0?0:0|l(e.length);t=c(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function l(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(s.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,n);case"utf8":case"utf-8":return j(this,e,n);case"ascii":return T(this,e,n);case"latin1":case"binary":return S(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,o){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"===typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,o);if("number"===typeof e)return e&=255,s.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,o){var i,a=1,c=t.length,s=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,c/=2,s/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var f=-1;for(i=n;i<c;i++)if(u(t,i)===u(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===s)return f*a}else-1!==f&&(i-=i-f),f=-1}else for(n+s>c&&(n=c-s),i=n;i>=0;i--){for(var h=!0,p=0;p<s;p++)if(u(t,i+p)!==u(e,p)){h=!1;break}if(h)return i}return-1}function y(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var c=parseInt(e.substr(2*a,2),16);if(isNaN(c))return a;t[n+a]=c}return a}function w(t,e,n,r){return Y(z(e,t.length-n),t,n,r)}function _(t,e,n,r){return Y(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return _(t,e,n,r)}function P(t,e,n,r){return Y(U(e),t,n,r)}function O(t,e,n,r){return Y(function(t,e){for(var n,r,o,i=[],a=0;a<t.length&&!((e-=2)<0);++a)r=(n=t.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function j(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,a,c,s,u=t[o],f=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=n)switch(h){case 1:u<128&&(f=u);break;case 2:128===(192&(i=t[o+1]))&&(s=(31&u)<<6|63&i)>127&&(f=s);break;case 3:i=t[o+1],a=t[o+2],128===(192&i)&&128===(192&a)&&(s=(15&u)<<12|(63&i)<<6|63&a)>2047&&(s<55296||s>57343)&&(f=s);break;case 4:i=t[o+1],a=t[o+2],c=t[o+3],128===(192&i)&&128===(192&a)&&128===(192&c)&&(s=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&c)>65535&&s<1114112&&(f=s)}null===f?(f=65533,h=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),o+=h}return function(t){var e=t.length;if(e<=M)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=M));return n}(r)}e.Buffer=s,e.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},e.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}(),e.kMaxLength=a(),s.poolSize=8192,s._augment=function(t){return t.__proto__=s.prototype,t},s.from=function(t,e,n){return u(null,t,e,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(t,e,n){return function(t,e,n,r){return f(e),e<=0?c(t,e):void 0!==n?"string"===typeof r?c(t,e).fill(n,r):c(t,e).fill(n):c(t,e)}(null,t,e,n)},s.allocUnsafe=function(t){return h(null,t)},s.allocUnsafeSlow=function(t){return h(null,t)},s.isBuffer=function(t){return!(null==t||!t._isBuffer)},s.compare=function(t,e){if(!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=s.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var a=t[n];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},s.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?j(this,0,t):v.apply(this,arguments)},s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},s.prototype.compare=function(t,e,n,r,o){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),c=Math.min(i,a),u=this.slice(r,o),f=t.slice(e,n),h=0;h<c;++h)if(u[h]!==f[h]){i=u[h],a=f[h];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return P(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function T(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function S(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function A(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=W(t[i]);return o}function L(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function D(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function I(t,e,n,r,o,i){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function F(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function C(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function R(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(t,e,n,r,i){return i||R(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,i){return i||R(t,0,n,8),o.write(t,e,n,r,52,8),n+8}s.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),s.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=s.prototype;else{var o=e-t;n=new s(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},s.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},s.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},s.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),o.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),o.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),o.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),o.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||I(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},s.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||I(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},s.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,1,255,0),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):C(this,t,e,!0),e+4},s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);I(this,t,e,n,o-1,-o)}var i=0,a=1,c=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===c&&0!==this[e+i-1]&&(c=1),this[e+i]=(t/a>>0)-c&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);I(this,t,e,n,o-1,-o)}var i=n-1,a=1,c=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===c&&0!==this[e+i+1]&&(c=1),this[e+i]=(t/a>>0)-c&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,1,127,-128),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):C(this,t,e,!0),e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||I(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},s.prototype.writeFloatLE=function(t,e,n){return k(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return k(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},s.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(i=e;i<n;++i)this[i]=t;else{var a=s.isBuffer(t)?t:z(new s(t,r).toString()),c=a.length;for(i=0;i<n-e;++i)this[i+e]=a[i%c]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function W(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function U(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!==0;)t+="=";return t}(t))}function Y(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n("jzzT"))},3:function(t,e){},"7W2i":function(t,e,n){var r=n("SksO");t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},"7qA8":function(t,e,n){"use strict";function r(t){var e="";if(!t)try{t=n(!function(){var t=new Error("Cannot find module 'fs'");throw t.code="MODULE_NOT_FOUND",t}())}catch(r){e=r.toString()}return{readFile:t?function(e){return new Promise((function(n,r){t.readFile(e,(function(t,e){return t?r(t):n(e)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)}}}n.d(e,"a",(function(){return r}))},"9DAu":function(t,e,n){"use strict";var r=n("J4zp");e.__esModule=!0,e.useIntersection=function(t){var e=t.rootMargin,n=t.disabled||!a,s=(0,o.useRef)(),u=(0,o.useState)(!1),f=r(u,2),h=f[0],p=f[1],l=(0,o.useCallback)((function(t){s.current&&(s.current(),s.current=void 0),n||h||t&&t.tagName&&(s.current=function(t,e,n){var r=function(t){var e=t.rootMargin||"",n=c.get(e);if(n)return n;var r=new Map,o=new IntersectionObserver((function(t){t.forEach((function(t){var e=r.get(t.target),n=t.isIntersecting||t.intersectionRatio>0;e&&n&&e(n)}))}),t);return c.set(e,n={id:e,observer:o,elements:r}),n}(n),o=r.id,i=r.observer,a=r.elements;return a.set(t,e),i.observe(t),function(){a.delete(t),i.unobserve(t),0===a.size&&(i.disconnect(),c.delete(o))}}(t,(function(t){return t&&p(t)}),{rootMargin:e}))}),[n,e,h]);return(0,o.useEffect)((function(){if(!a&&!h){var t=(0,i.requestIdleCallback)((function(){return p(!0)}));return function(){return(0,i.cancelIdleCallback)(t)}}}),[h]),[l,h]};var o=n("BqPY"),i=n("s4GJ"),a="undefined"!==typeof IntersectionObserver;var c=new Map},Bnag:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},EbDI:function(t,e){t.exports=function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},Ijbi:function(t,e,n){var r=n("WkPL");t.exports=function(t){if(Array.isArray(t))return r(t)}},Ik3D:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},N6lM:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n("RNiq")}])},Nsbk:function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},PJYZ:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},RIqP:function(t,e,n){var r=n("Ijbi"),o=n("EbDI"),i=n("ZhPi"),a=n("Bnag");t.exports=function(t){return r(t)||o(t)||i(t)||a()}},RNiq:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return Fn}));var r=n("khMU"),o=n.n(r),i=n("nKUr");function a(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){a(i,r,o,c,s,"next",t)}function s(t){a(i,r,o,c,s,"throw",t)}c(void 0)}))}}var s=n("Ruhs"),u=n.n(s),f=n("Tred"),h=n.n(f),p=n("lFXY"),l=n.n(p);function d(t){var e=t.children;return Object(i.jsxs)("div",{className:h.a.container,children:[Object(i.jsx)(u.a,{children:Object(i.jsx)("link",{rel:"icon",href:"/favicon.ico"})}),Object(i.jsx)("header",{className:h.a.header}),Object(i.jsx)("main",{children:e}),Object(i.jsx)("div",{className:h.a.backToHome,children:Object(i.jsx)(l.a,{href:"/",children:Object(i.jsx)("a",{children:"\u2190 Back to home"})})})]})}var v=n("Z4Yb"),m=n.n(v),b=n("lT9W");function g(t,e,n){if(void 0===n&&(n=!1),t.beginPath(),e.slice(1).forEach((function(n,r){var o=n.x,i=n.y,a=e[r];t.moveTo(a.x,a.y),t.lineTo(o,i)})),n){var r=e[e.length-1],o=e[0];if(!r||!o)return;t.moveTo(r.x,r.y),t.lineTo(o.x,o.y)}t.stroke()}var y=n("mrSG"),w=function(){function t(t,e){if(!S(t)||!S(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function _(t,e){return t instanceof b.a&&t.shape.length===e}function x(t){return _(t,3)}function P(t){return _(t,4)}function O(t){return t%2===0}function E(t,e){void 0===e&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function j(t){return t&&t.width&&t.height}function M(t){return t.reduce((function(t,e){return t.add(e)}),new L(0,0)).div(new L(t.length,t.length))}function T(t,e,n){return Array(t).fill(0).map((function(t,r){return e+r*n}))}function S(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}function A(t){return S(t)&&0<=t&&t<=1}var L=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),D=function(){function t(e,n){void 0===n&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(S),i=[r.x,r.y,r.width,r.height].every(S);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],c=a[0],s=a[1],u=a[2],f=a[3];t.assertIsValidBox({x:c,y:s,width:u,height:f},"Box.constructor",n),this._x=c,this._y=s,this._width=u,this._height=f}return t.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(S)},t.assertIsValidBox=function(e,n,r){if(void 0===r&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new L(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new L(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new L(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new L(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.round(t)}));return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.floor(t)}));return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.toSquare=function(){var e=this,n=e.x,r=e.y,o=e.width,i=e.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new t({x:n,y:r,width:o,height:i})},t.prototype.rescale=function(e){var n=j(e)?e.width:e,r=j(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n];return new t({x:r[0],y:r[1],width:r[2],height:r[3]})},t.prototype.clipAtImageBorders=function(e,n){var r=this,o=r.x,i=r.y,a=r.right,c=r.bottom,s=Math.max(o,0),u=Math.max(i,0),f=a-s,h=c-u;return new t({x:s,y:u,width:Math.min(f,e-s),height:Math.min(h,n-u)}).floor()},t.prototype.shift=function(e,n){var r=this.width,o=this.height;return new t({x:this.x+e,y:this.y+n,width:r,height:o})},t.prototype.padAtBorders=function(t,e){var n=this.width+1,r=this.height+1,o=n,i=r,a=this.left,c=this.top,s=this.right,u=this.bottom;return s>e&&(o=-s+e+n,s=e),u>t&&(i=-u+t+r,u=t),a<1&&(i=2-a,a=1),c<1&&(i=2-c,c=1),{dy:1,edy:i,dx:1,edx:o,y:c,ey:u,x:a,ex:s,w:n,h:r}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),I=function(t){function e(e,n,r,o,i){return void 0===i&&(i=!1),t.call(this,{left:e,top:n,right:r,bottom:o},i)||this}return Object(y.c)(e,t),e}(D),F=function(){function t(t,e,n,r,o){this._imageDims=new w(o.width,o.height),this._score=t,this._classScore=e,this._className=n,this._box=new D(r).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new D(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),C=function(t){function e(e,n,r){return t.call(this,e,e,"",n,r)||this}return Object(y.c)(e,t),e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r);return new e(o.score,o.relativeBox,o.imageDims)},e}(F);function R(t,e,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return n?r/(t.area+e.area-r):r/Math.min(t.area,e.area)}function k(t,e,n,r){void 0===r&&(r=!0);for(var o=e.map((function(t,e){return{score:t,boxIndex:e}})).sort((function(t,e){return t.score-e.score})).map((function(t){return t.boxIndex})),i=[],a=function(){var e=o.pop();i.push(e);for(var a=o,c=[],s=0;s<a.length;s++){var u=a[s],f=t[e],h=t[u];c.push(R(f,h,r))}o=o.filter((function(t,e){return c[e]<=n}))};o.length>0;)a();return i}function B(t,e){return b.L((function(){var n=e[0],r=e[1],o=e[2],i=b.n(Object(y.e)(t.shape.slice(0,3),[1]),n),a=b.n(Object(y.e)(t.shape.slice(0,3),[1]),r),c=b.n(Object(y.e)(t.shape.slice(0,3),[1]),o),s=b.h([i,a,c],3);return b.F(t,s)}))}function N(t){return 1/(1+Math.exp(-t))}var W=function(t){function e(e,n,r,o,i){return void 0===i&&(i=!1),t.call(this,{x:e,y:n,width:r,height:o},i)||this}return Object(y.c)(e,t),e}(D),z=function(){function t(t,e,n){void 0===n&&(n=new L(0,0));var r=e.width,o=e.height;this._imgDims=new w(r,o),this._shift=n,this._positions=t.map((function(t){return t.mul(new L(r,o)).add(n)}))}return Object.defineProperty(t.prototype,"shift",{get:function(){return new L(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map((function(e){return e.sub(t._shift).div(new L(t.imageWidth,t.imageHeight))}))},enumerable:!0,configurable:!0}),t.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},t.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new L(t,e))},t.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},t.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var n=t instanceof C?t.box.floor():new D(t);return this.shiftBy(n.x,n.y).align(null,e)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),o=r.useDlibAlignment,i=r.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},t.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],r=t[2],o=function(t){return r.sub(t).magnitude()},i=(o(e)+o(n))/2,a=Math.floor(i/.45),c=M(t),s=Math.floor(Math.max(0,c.x-.5*a)),u=Math.floor(Math.max(0,c.y-.43*a));return new W(s,u,Math.min(a,this.imageWidth+s),Math.min(a,this.imageHeight+u))},t.prototype.alignMinBbox=function(t){var e=function(t){var e=t.map((function(t){return t.x})),n=t.map((function(t){return t.y})),r=e.reduce((function(t,e){return e<t?e:t}),1/0),o=n.reduce((function(t,e){return e<t?e:t}),1/0),i=e.reduce((function(t,e){return t<e?e:t}),0),a=n.reduce((function(t,e){return t<e?e:t}),0);return new I(r,o,i,a)}(this.positions);return e.pad(e.width*t,e.height*t)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],M([t[3],t[4]])]},e}(z),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(M)},e}(z),H=function(){function t(t,e){this._label=t,this._distance=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){return void 0===t&&(t=!0),this.label+(t?" ("+E(this.distance)+")":"")},t}(),G=function(t){function e(e,n){var r=t.call(this,e)||this;return r._label=n,r}return Object(y.c)(e,t),e.assertIsValidLabeledBox=function(t,e){if(D.assertIsValidBox(t,e),!S(t.label))throw new Error(e+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(D),q=function(){function t(t,e){if("string"!==typeof t)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some((function(t){return!(t instanceof Float32Array)})))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map((function(t){return Array.from(t)}))}},t.fromJSON=function(e){var n=e.descriptors.map((function(t){return new Float32Array(t)}));return new t(e.label,n)},t}();!function(t){function e(e,n,r,o){var i=t.call(this,e,n)||this;return i._score=r,i._classScore=o,i}Object(y.c)(e,t),e.assertIsValidPredictedBox=function(t,e){if(G.assertIsValidLabeledBox(t,e),!A(t.score)||!A(t.classScore))throw new Error(e+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(G);function V(t){return t.detection instanceof C}function J(t,e){var n={detection:e};return Object.assign({},t,n)}function X(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}var K=n("7qA8"),Z=n("YC04");function $(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}var Q,tt=n("q6vP");function et(t){Q=t}function nt(){$()&&et(X()),Object(tt.a)()&&et(Object(Z.a)())}var rt,ot={getEnv:function(){if(!Q)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Q},setEnv:et,initialize:nt,createBrowserEnv:X,createFileSystem:K.a,createNodejsEnv:Z.a,monkeyPatch:function(t){if(Q||nt(),!Q)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=void 0===e?Q.Canvas:e,r=t.Image,o=void 0===r?Q.Image:r;Q.Canvas=n,Q.Image=o,Q.createCanvasElement=t.createCanvasElement||function(){return new n},Q.createImageElement=t.createImageElement||function(){return new o},Q.ImageData=t.ImageData||Q.ImageData,Q.Video=t.Video||Q.Video,Q.fetch=t.fetch||Q.fetch,Q.readFile=t.readFile||Q.readFile},isBrowser:$,isNodejs:tt.a};function it(t){return ot.isNodejs()||"string"!==typeof t?t:document.getElementById(t)}function at(t){var e=ot.getEnv(),n=e.Canvas;if(t instanceof e.CanvasRenderingContext2D)return t;var r=it(t);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=r.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}nt(),function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"}(rt||(rt={}));var ct=function(t){void 0===t&&(t={});var e=t.anchorPosition,n=t.backgroundColor,r=t.fontColor,o=t.fontSize,i=t.fontStyle,a=t.padding;this.anchorPosition=e||rt.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=i||"Georgia",this.padding=a||4},st=function(){function t(e,n,r){void 0===r&&(r={}),this.text="string"===typeof e?[e]:e instanceof t?e.text:e,this.anchor=n,this.options=new ct(r)}return t.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map((function(e){return t.measureText(e).width})).reduce((function(t,e){return t<e?e:t}),0)+2*e},t.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,n=t.padding;return this.text.length*e+2*n},t.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,r=n===rt.BOTTOM_RIGHT||n===rt.TOP_RIGHT,o=n===rt.BOTTOM_LEFT||n===rt.BOTTOM_RIGHT,i=this.measureWidth(t),a=this.measureHeight(),c=r?this.anchor.x-i:this.anchor.x,s=o?this.anchor.y-a:this.anchor.y;if(e){var u=e.width,f=e.height;return{x:Math.max(Math.min(c,u-i),0),y:Math.max(Math.min(s,f-a),0)}}return{x:c,y:s}},t.prototype.draw=function(t){var e=it(t),n=at(e),r=this.options,o=r.backgroundColor,i=r.fontColor,a=r.fontSize,c=r.fontStyle,s=r.padding;n.font=a+"px "+c;var u=this.measureWidth(n),f=this.measureHeight();n.fillStyle=o;var h=this.getUpperLeft(n,e);n.fillRect(h.x,h.y,u,f),n.fillStyle=i,this.text.forEach((function(t,e){var r=s+h.x,o=s+h.y+(e+1)*a;n.fillText(t,r,o)}))},t}(),ut=function(t){void 0===t&&(t={});var e=t.boxColor,n=t.lineWidth,r=t.label,o=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:rt.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new ct(Object.assign({},i,o))};!function(){function t(t,e){void 0===e&&(e={}),this.box=new D(t),this.options=new ut(e)}t.prototype.draw=function(t){var e=at(t),n=this.options,r=n.boxColor,o=n.lineWidth,i=this.box,a=i.x,c=i.y,s=i.width,u=i.height;e.strokeStyle=r,e.lineWidth=o,e.strokeRect(a,c,s,u);var f=this.options.label;f&&new st([f],{x:a-o/2,y:c},this.options.drawLabelOptions).draw(t)}}();function ft(t){var e=ot.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function ht(t){var e=ot.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new w(t.naturalWidth,t.naturalHeight):t instanceof r?new w(t.videoWidth,t.videoHeight):new w(t.width,t.height)}function pt(t){var e=t.width,n=t.height,r=(0,ot.getEnv().createCanvasElement)();return r.width=e,r.height=n,r}function lt(t,e){var n=ot.getEnv().ImageData;if(!(t instanceof n)&&!ft(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=e||ht(t),o=r.width,i=r.height,a=pt({width:o,height:i});return t instanceof n?at(a).putImageData(t,0,0):at(a).drawImage(t,0,0,o,i),a}function dt(t,e){return Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i,a,c;return Object(y.d)(this,(function(s){switch(s.label){case 0:return n=e||ot.getEnv().createCanvasElement(),r=t.shape.slice(P(t)?1:0),o=r[0],i=r[1],a=r[2],c=b.L((function(){return t.as3D(o,i,a).toInt()})),[4,b.f.toPixels(c,n)];case 1:return s.sent(),c.dispose(),[2,n]}}))}))}function vt(t){var e=ot.getEnv(),n=e.Image,r=e.Canvas,o=e.Video;return t instanceof n||t instanceof r||t instanceof o}var mt=function(){function t(t,e){var n=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach((function(t,e){if(x(t))return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape);if(P(t)){var r=t.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape.slice(1))}var o=t instanceof ot.getEnv().Canvas?t:lt(t);n._canvases[e]=o,n._inputDimensions[e]=[o.height,o.width,3]}))}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var t=this;return T(this.batchSize,0,1).map((function(e,n){return t.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),t.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},t.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},t.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},t.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},t.prototype.getReshapedInputDimensions=function(t){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function(t,e){var n=t.width,r=t.height,o=e/Math.max(r,n);return new w(Math.round(n*o),Math.round(r*o))}({width:this.getInputWidth(t),height:this.getInputHeight(t)},this.inputSize)},t.prototype.toBatchTensor=function(t,e){var n=this;return void 0===e&&(e=!0),this._inputSize=t,b.L((function(){var r=T(n.batchSize,0,1).map((function(r){var o=n.getInput(r);if(o instanceof b.a){var i=P(o)?o:o.expandDims();return(i=function(t,e){return void 0===e&&(e=!1),b.L((function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var i=Math.abs(r-o),a=Math.round(i*(e?.5:1)),c=r>o?2:1,s=function(e){var n=t.shape.slice();return n[c]=e,b.n(n,0)},u=s(a),f=i-u.shape[c],h=[e&&f?s(f):null,t,u].filter((function(t){return!!t})).map((function(t){return t.toFloat()}));return b.h(h,c)}))}(i,e)).shape[1]===t&&i.shape[2]===t||(i=b.o.resizeBilinear(i,[t,t])),i.as3D(t,t,3)}if(o instanceof ot.getEnv().Canvas)return b.f.fromPixels(function(t,e,n){void 0===n&&(n=!1);var r=ot.getEnv(),o=r.Image,i=r.Canvas;if(!(t instanceof o||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=ht(t),c=e/Math.max(a.height,a.width),s=c*a.width,u=c*a.height,f=pt({width:e,height:e}),h=t instanceof i?t:lt(t),p=Math.abs(s-u)/2,l=n&&s<u?p:0,d=n&&u<s?p:0;return at(f).drawImage(h,l,d,s,u),f}(o,t,e));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)}));return b.E(r.map((function(t){return t.toFloat()}))).as4D(n.batchSize,t,t,3)}))},t}();function bt(t){return Object(y.b)(this,void 0,void 0,(function(){var e,n,r;return Object(y.d)(this,(function(o){switch(o.label){case 0:if(t instanceof mt)return[2,t];if(!(e=Array.isArray(t)?t:[t]).length)throw new Error("toNetInput - empty array passed as input");return n=function(e){return Array.isArray(t)?" at input index "+e+":":""},(r=e.map(it)).forEach((function(t,r){if(!vt(t)&&!x(t)&&!P(t)){if("string"===typeof e[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+e[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(P(t)){var o=t.shape[0];if(1!==o)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(t){return vt(t)&&(e=t,new Promise((function(t,n){if(e instanceof ot.getEnv().Canvas||ft(e))return t();function r(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",o),t(e))}function o(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),n(t))}e.addEventListener("load",r),e.addEventListener("error",o)})));var e})))];case 1:return o.sent(),[2,new mt(r,Array.isArray(t))]}}))}))}function gt(t,e){return Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i,a,c;return Object(y.d)(this,(function(s){switch(s.label){case 0:return n=ot.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,bt(t)];case 1:if((o=s.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=o.getInput(0))instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,dt(i)];case 3:a=s.sent(),s.label=4;case 4:r=a,s.label=5;case 5:return c=at(r),[2,e.map((function(t){return t instanceof C?t.forSize(r.width,r.height).box.floor():t})).map((function(t){return t.clipAtImageBorders(r.width,r.height)})).map((function(t){var e=t.x,n=t.y,r=t.width,o=t.height,i=pt({width:r,height:o});return at(i).putImageData(c.getImageData(e,n,r,o),0,0),i}))]}}))}))}function yt(t,e){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(n){if(!x(t)&&!P(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(P(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,b.L((function(){var n=t.shape.slice(P(t)?1:0),r=n[0],o=n[1],i=n[2];return e.map((function(t){return t instanceof C?t.forSize(o,r).box:t})).map((function(t){return t.clipAtImageBorders(o,r)})).map((function(e){var n=e.x,a=e.y,c=e.width,s=e.height;return b.C(t.as3D(r,o,i),[a,n,0],[s,c,i])}))}))]}))}))}function wt(t,e){return Object(y.b)(this,void 0,void 0,(function(){var n;return Object(y.d)(this,(function(r){switch(r.label){case 0:return[4,(0,ot.getEnv().fetch)(t,e)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}}))}))}function _t(t){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(e){switch(e.label){case 0:return[4,wt(t)];case 1:return[2,e.sent().json()]}}))}))}function xt(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"",o=(t=t.replace(r,"")).split("/").filter((function(t){return t})),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=t.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function Pt(t,e){return Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i;return Object(y.d)(this,(function(a){switch(a.label){case 0:return n=xt(t,e),r=n.manifestUri,o=n.modelBaseUri,[4,_t(r)];case 1:return i=a.sent(),[2,b.p.loadWeights(i,o)]}}))}))}var Ot=function(){function t(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t);return e.obj[e.objProp]},t.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;r[o].dispose(),r[o]=e},t.prototype.getParamList=function(){var t=this;return this._paramMappings.map((function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}}))},t.prototype.getTrainableParams=function(){return this.getParamList().filter((function(t){return t.tensor instanceof b.b}))},t.prototype.getFrozenParams=function(){return this.getParamList().filter((function(t){return!(t.tensor instanceof b.b)}))},t.prototype.variable=function(){var t=this;this.getFrozenParams().forEach((function(e){var n=e.path,r=e.tensor;t.reassignParamFromPath(n,r.variable())}))},t.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach((function(e){var n=e.path,r=e.tensor,o=b.G(r.dataSync());r.dispose(),t.reassignParamFromPath(n,o)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach((function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()})),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(t){var e=t.tensor;return Array.from(e.dataSync())})).reduce((function(t,e){return t.concat(e)})))},t.prototype.load=function(t){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.loadFromUri=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:if(t&&"string"!==typeof t)throw new Error(this._name+".loadFromUri - expected model uri");return[4,Pt(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}}))}))},t.prototype.loadFromDisk=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e,n,r,o,i,a,c,s,u,f;return Object(y.d)(this,(function(h){switch(h.label){case 0:if(t&&"string"!==typeof t)throw new Error(this._name+".loadFromDisk - expected model file path");return e=ot.getEnv().readFile,n=xt(t,this.getDefaultModelName()),r=n.manifestUri,o=n.modelBaseUri,i=function(t){return Promise.all(t.map((function(t){return e(t).then((function(t){return t.buffer}))})))},a=b.p.weightsLoaderFactory(i),u=(s=JSON).parse,[4,e(r)];case 1:return c=u.apply(s,[h.sent().toString()]),[4,a(c,o)];case 2:return f=h.sent(),this.loadFromWeightMap(f),[2]}}))}))},t.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce((function(e,n){if(!e.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+t);return{obj:e.nextObj,objProp:n,nextObj:e.nextObj[n]}}),{nextObj:this.params}),n=e.obj,r=e.objProp;if(!n||!r||!(n[r]instanceof b.a))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:r}},t}();function Et(t,e,n){return b.L((function(){var r=b.z(t,e.depthwise_filter,e.pointwise_filter,n,"same");return r=b.c(r,e.bias)}))}function jt(t,e,n){return void 0===n&&(n=!1),b.L((function(){var r=b.w(n?b.c(b.i(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):Et(t,e.conv0,[2,2])),o=Et(r,e.conv1,[1,1]),i=Et(b.w(b.c(r,o)),e.conv2,[1,1]);return b.w(b.c(r,b.c(o,i)))}))}function Mt(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),b.L((function(){var o=b.w(n?b.c(b.i(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):Et(t,e.conv0,r?[2,2]:[1,1])),i=Et(o,e.conv1,[1,1]),a=Et(b.w(b.c(o,i)),e.conv2,[1,1]),c=Et(b.w(b.c(o,b.c(i,a))),e.conv3,[1,1]);return b.w(b.c(o,b.c(i,b.c(a,c))))}))}function Tt(t,e,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),b.L((function(){var o=b.c(b.i(t,e.filters,[1,1],n),e.bias);return r?b.w(o):o}))}function St(t,e){Object.keys(t).forEach((function(n){e.some((function(t){return t.originalPath===n}))||t[n].dispose()}))}function At(t,e){return function(n,r,o,i){var a=b.K(t(n*r*o*o),[o,o,n,r]),c=b.H(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:c}}}function Lt(t,e){return function(n,r,o){var i=b.I(t(n*r),[n,r]),a=b.H(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var Dt=function(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n};function It(t,e){return function(n,r,o){var i=b.K(t(9*n),[3,3,n,1]),a=b.K(t(n*r),[1,1,n,r]),c=b.H(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new Dt(i,a,c)}}function Ft(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),o=t(e+"/bias",1);return new Dt(n,r,o)}}function Ct(t,e){return function(n,r,o){var i=t[n];if(!_(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function Rt(t){var e=t;return{extractWeights:function(t){var n=e.slice(0,t);return e=e.slice(t),n},getRemainingWeights:function(){return e}}}function kt(t,e){var n=At(t,e),r=It(t,e);function o(t,e,o,i){return void 0===i&&(i=!1),{conv0:i?n(t,e,3,o+"/conv0"):r(t,e,o+"/conv0"),conv1:r(e,e,o+"/conv1"),conv2:r(e,e,o+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(t,e,n,i){void 0===i&&(i=!1);var a=o(t,e,n,i);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(e,e,n+"/conv3")}}}}function Bt(t){return function(e){return{filters:t(e+"/filters",4),bias:t(e+"/bias",1)}}}function Nt(t,e){var n=Ct(t,e),r=Bt(n),o=Ft(n);return{extractDenseBlock3Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2")}},extractDenseBlock4Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2"),conv3:o(t+"/conv3")}}}}var Wt=function(t){function e(){return t.call(this,"FaceFeatureExtractor")||this}return Object(y.c)(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceFeatureExtractor - load model before inference");return b.L((function(){var n=Mt(B(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(b.y(255)),e.dense0,!0);return n=Mt(n,e.dense1),n=Mt(n,e.dense2),n=Mt(n,e.dense3),n=b.d(n,[7,7],[2,2],"valid")}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=Nt(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return St(t,e),{params:r,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=Rt(t),r=n.extractWeights,o=n.getRemainingWeights,i=kt(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),c=i(32,64,"dense1"),s=i(64,128,"dense2"),u=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:c,dense2:s,dense3:u}}}(t)},e}(Ot);function zt(t,e){return b.L((function(){return b.c(b.q(t,e.weights),e.bias)}))}function Ut(t){var e={},n={};return Object.keys(t).forEach((function(r){(r.startsWith("fc")?n:e)[r]=t[r]})),{featureExtractorMap:e,classifierMap:n}}var Yt=function(t){function e(e,n){var r=t.call(this,e)||this;return r._faceFeatureExtractor=n,r}return Object(y.c)(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return b.L((function(){var r=t instanceof mt?e.faceFeatureExtractor.forwardInput(t):t;return zt(r.as2D(r.shape[0],-1),n.fc)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return function(t,e,n){var r=[],o=Rt(t),i=o.extractWeights,a=o.getRemainingWeights,c=Lt(i,r)(e,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:c}}}(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var e=Ut(t),n=e.featureExtractorMap,r=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(t){var e,n=[],r=Ct(t,n),o={fc:(e="fc",{weights:r(e+"/weights",2),bias:r(e+"/bias",1)})};return St(t,n),{params:o,paramMappings:n}}(r)},e.prototype.extractParams=function(t){var e=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*e+n,o=t.slice(0,t.length-r),i=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(Ot),Ht=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Gt=function(){function t(t){var e=this;if(7!==t.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Ht.forEach((function(n,r){e[n]=t[r]}))}return t.prototype.asSortedArray=function(){var t=this;return Ht.map((function(e){return{expression:e,probability:t[e]}})).sort((function(t,e){return e.probability-t.probability}))},t}(),qt=function(t){function e(e){return void 0===e&&(e=new Wt),t.call(this,"FaceExpressionNet",e)||this}return Object(y.c)(e,t),e.prototype.forwardInput=function(t){var e=this;return b.L((function(){return b.D(e.runNet(t))}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictExpressions=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e,n,r,o,i=this;return Object(y.d)(this,(function(a){switch(a.label){case 0:return[4,bt(t)];case 1:return e=a.sent(),[4,this.forwardInput(e)];case 2:return n=a.sent(),[4,Promise.all(b.O(n).map((function(t){return Object(y.b)(i,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,t.data()];case 1:return e=n.sent(),t.dispose(),[2,e]}}))}))})))];case 3:return r=a.sent(),n.dispose(),o=r.map((function(t){return new Gt(t)})),[2,e.isBatchInput?o:o[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(Yt);function Vt(t,e){var n={expressions:e};return Object.assign({},t,n)}function Jt(t){return V(t)&&t.landmarks instanceof z&&t.unshiftedLandmarks instanceof z&&t.alignedRect instanceof C}function Xt(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a={landmarks:r,unshiftedLandmarks:e,alignedRect:new C(t.detection.score,o.rescale(i.reverse()),i)};return Object.assign({},t,a)}var Kt=function(t){void 0===t&&(t={});var e=t.drawLines,n=void 0===e||e,r=t.drawPoints,o=void 0===r||r,i=t.lineWidth,a=t.lineColor,c=t.pointSize,s=t.pointColor;this.drawLines=n,this.drawPoints=o,this.lineWidth=i||1,this.pointSize=c||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"};!function(){function t(t,e){void 0===e&&(e={}),this.faceLandmarks=t,this.options=new Kt(e)}t.prototype.draw=function(t){var e=at(t),n=this.options,r=n.drawLines,o=n.drawPoints,i=n.lineWidth,a=n.lineColor,c=n.pointSize,s=n.pointColor;if(r&&this.faceLandmarks instanceof Y&&(e.strokeStyle=a,e.lineWidth=i,g(e,this.faceLandmarks.getJawOutline()),g(e,this.faceLandmarks.getLeftEyeBrow()),g(e,this.faceLandmarks.getRightEyeBrow()),g(e,this.faceLandmarks.getNose()),g(e,this.faceLandmarks.getLeftEye(),!0),g(e,this.faceLandmarks.getRightEye(),!0),g(e,this.faceLandmarks.getMouth(),!0)),o){e.strokeStyle=s,e.fillStyle=s;this.faceLandmarks.positions.forEach((function(t){e.beginPath(),e.arc(t.x,t.y,c,0,2*Math.PI),e.fill()}))}}}();function Zt(t,e){var n=[],r=Rt(t),o=r.extractWeights,i=r.getRemainingWeights,a=function(t,e){var n=At(t,e),r=It(t,e);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(t,e,o){return{separable_conv0:r(t,e,o+"/separable_conv0"),separable_conv1:r(e,e,o+"/separable_conv1"),expansion_conv:n(t,e,1,o+"/expansion_conv")}},extractMainBlockParams:function(t,e){return{separable_conv0:r(t,t,e+"/separable_conv0"),separable_conv1:r(t,t,e+"/separable_conv1"),separable_conv2:r(t,t,e+"/separable_conv2")}}}}(o,n),c=a.extractConvParams,s=a.extractSeparableConvParams,u=a.extractReductionBlockParams,f=a.extractMainBlockParams,h={conv_in:c(3,32,3,"entry_flow/conv_in"),reduction_block_0:u(32,64,"entry_flow/reduction_block_0"),reduction_block_1:u(64,128,"entry_flow/reduction_block_1")},p={};T(e,0,1).forEach((function(t){p["main_block_"+t]=f(128,"middle_flow/main_block_"+t)}));var l={reduction_block:u(128,256,"exit_flow/reduction_block"),separable_conv:s(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:h,middle_flow:p,exit_flow:l}}}function $t(t,e){var n=[],r=function(t,e){var n=Ct(t,e),r=Bt(n),o=Ft(n);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),expansion_conv:r(t+"/expansion_conv")}},extractMainBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),separable_conv2:o(t+"/separable_conv2")}}}}(t,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,c=r.extractMainBlockParams,s={conv_in:o("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},u={};T(e,0,1).forEach((function(t){u["main_block_"+t]=c("middle_flow/main_block_"+t)}));var f={reduction_block:a("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return St(t,n),{params:{entry_flow:s,middle_flow:u,exit_flow:f},paramMappings:n}}function Qt(t,e,n){return b.c(b.i(t,e.filters,n,"same"),e.bias)}function te(t,e,n){void 0===n&&(n=!0);var r=n?b.w(t):t;return r=Et(r,e.separable_conv0,[1,1]),r=Et(b.w(r),e.separable_conv1,[1,1]),r=b.s(r,[3,3],[2,2],"same"),r=b.c(r,Qt(t,e.expansion_conv,[2,2]))}var ee,ne=function(t){function e(e){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return Object(y.c)(e,t),e.prototype.forwardInput=function(t){var e=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return b.L((function(){var r=B(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(b.y(256)),o=b.w(Qt(r,n.entry_flow.conv_in,[2,2]));return o=te(o,n.entry_flow.reduction_block_0,!1),o=te(o,n.entry_flow.reduction_block_1),T(e._numMainBlocks,0,1).forEach((function(t){o=function(t,e){var n=Et(b.w(t),e.separable_conv0,[1,1]);return n=Et(b.w(n),e.separable_conv1,[1,1]),n=Et(b.w(n),e.separable_conv2,[1,1]),b.c(n,t)}(o,n.middle_flow["main_block_"+t])})),o=te(o,n.exit_flow.reduction_block),o=b.w(Et(o,n.exit_flow.separable_conv,[1,1]))}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return $t(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return Zt(t,this._numMainBlocks)},e}(Ot);!function(t){t.FEMALE="female",t.MALE="male"}(ee||(ee={}));var re=function(t){function e(e){void 0===e&&(e=new ne(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return Object(y.c)(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return b.L((function(){var r=t instanceof mt?e.faceFeatureExtractor.forwardInput(t):t,o=b.d(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:zt(o,n.fc.age).as1D(),gender:zt(o,n.fc.gender)}}))},e.prototype.forwardInput=function(t){var e=this;return b.L((function(){var n=e.runNet(t),r=n.age,o=n.gender;return{age:r,gender:b.D(o)}}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictAgeAndGender=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e,n,r,o,i,a,c=this;return Object(y.d)(this,(function(s){switch(s.label){case 0:return[4,bt(t)];case 1:return e=s.sent(),[4,this.forwardInput(e)];case 2:return n=s.sent(),r=b.O(n.age),o=b.O(n.gender),i=r.map((function(t,e){return{ageTensor:t,genderTensor:o[e]}})),[4,Promise.all(i.map((function(t){var e=t.ageTensor,n=t.genderTensor;return Object(y.b)(c,void 0,void 0,(function(){var t,r,o,i,a;return Object(y.d)(this,(function(c){switch(c.label){case 0:return[4,e.data()];case 1:return t=c.sent()[0],[4,n.data()];case 2:return r=c.sent()[0],i=(o=r>.5)?ee.MALE:ee.FEMALE,a=o?r:1-r,e.dispose(),n.dispose(),[2,{age:t,gender:i,genderProbability:a}]}}))}))})))];case 3:return a=s.sent(),n.age.dispose(),n.gender.dispose(),[2,e.isBatchInput?a:a[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return function(t){var e=[],n=Rt(t),r=n.extractWeights,o=n.getRemainingWeights,i=Lt(r,e),a=i(512,1,"fc/age"),c=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:c}}}}(t)},e.prototype.extractParamsFromWeigthMap=function(t){var e=Ut(t),n=e.featureExtractorMap,r=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(t){var e=[],n=Ct(t,e);function r(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return St(t,e),{params:o,paramMappings:e}}(r)},e.prototype.extractParams=function(t){var e=t.slice(0,t.length-1539),n=t.slice(t.length-1539);return this.faceFeatureExtractor.extractWeights(e),this.extractClassifierParams(n)},e}(Ot),oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.postProcess=function(t,e,n){var r=n.map((function(t){var n=t.width,r=t.height,o=e/Math.max(r,n);return{width:n*o,height:r*o}})),o=r.length;return b.L((function(){var n=function(t,e){return b.E([b.n([68],t),b.n([68],e)],1).as2D(1,136).as1D()},i=function(t,e){var n=r[t],o=n.width,i=n.height;return e(o,i)?Math.abs(o-i)/2:0};return t.mul(b.n([o,136],e)).sub(b.E(Array.from(Array(o),(function(t,e){return n(function(t){return i(t,(function(t,e){return t<e}))}(e),function(t){return i(t,(function(t,e){return e<t}))}(e))})))).div(b.E(Array.from(Array(o),(function(t,e){return n(r[e].width,r[e].height)}))))}))},e.prototype.forwardInput=function(t){var e=this;return b.L((function(){var n=e.runNet(t);return e.postProcess(n,t.inputSize,t.inputDimensions.map((function(t){return{height:t[0],width:t[1]}})))}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.detectLandmarks=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e,n,r,o=this;return Object(y.d)(this,(function(i){switch(i.label){case 0:return[4,bt(t)];case 1:return e=i.sent(),n=b.L((function(){return b.O(o.forwardInput(e))})),[4,Promise.all(n.map((function(t,n){return Object(y.b)(o,void 0,void 0,(function(){var r,o,i,a,c;return Object(y.d)(this,(function(s){switch(s.label){case 0:return i=(o=Array).from,[4,t.data()];case 1:return r=i.apply(o,[s.sent()]),a=r.filter((function(t,e){return O(e)})),c=r.filter((function(t,e){return!O(e)})),[2,new Y(Array(68).fill(0).map((function(t,e){return new L(a[e],c[e])})),{height:e.getInputHeight(n),width:e.getInputWidth(n)})]}}))}))})))];case 2:return r=i.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getClassifierChannelsOut=function(){return 136},e}(Yt),ie=function(t){function e(e){return void 0===e&&(e=new Wt),t.call(this,"FaceLandmark68Net",e)||this}return Object(y.c)(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(oe);var ae=function(t){function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return Object(y.c)(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("TinyFaceFeatureExtractor - load model before inference");return b.L((function(){var n=jt(B(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(b.y(255)),e.dense0,!0);return n=jt(n,e.dense1),n=jt(n,e.dense2),n=b.d(n,[14,14],[2,2],"valid")}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=Nt(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return St(t,e),{params:r,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=Rt(t),r=n.extractWeights,o=n.getRemainingWeights,i=kt(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),c=i(32,64,"dense1"),s=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:c,dense2:s}}}(t)},e}(Ot),ce=function(t){function e(e){return void 0===e&&(e=new ae),t.call(this,"FaceLandmark68TinyNet",e)||this}return Object(y.c)(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(oe);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(y.c)(e,t)}(ie);function se(t,e,n,r,o){void 0===o&&(o="same");var i=e.conv,a=i.filters,c=i.bias,s=b.i(t,a,n,o);return s=function(t,e){return b.c(b.t(t,e.weights),e.biases)}(s=b.c(s,c),e.scale),r?b.w(s):s}function ue(t,e){return se(t,e,[1,1],!1)}function fe(t,e){return se(t,e,[2,2],!0,"valid")}function he(t,e){function n(n,r,o,i){var a=function(e,n,r){var o=t(e),i=o.length/(n*r*r);if(i%1!==0)throw new Error("depth has to be an integer: "+i+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return b.L((function(){return b.N(b.K(o,[n,i,r,r]),[2,3,1,0])}))}(n,r,o),c=b.H(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:c}}function r(r,o,i,a){return{conv:n(r,o,i,a+"/conv"),scale:function(n,r){var o=b.H(t(n)),i=b.H(t(n));return e.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:o,biases:i}}(o,a+"/scale")}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t,e,n,o,i){return void 0===i&&(i=!1),{conv1:r((i?.5:1)*t,e,n,o+"/conv1"),conv2:r(t,e,n,o+"/conv2")}}}}function pe(t,e){var n=Ct(t,e);function r(t){return{conv:{filters:n(t+"/conv/filters",4),bias:n(t+"/conv/bias",1)},scale:function(t){return{weights:n(t+"/scale/weights",1),biases:n(t+"/scale/biases",1)}}(t)}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t){return{conv1:r(t+"/conv1"),conv2:r(t+"/conv2")}}}}function le(t){var e=[],n=pe(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),c=o("conv32_2"),s=o("conv32_3"),u=o("conv64_down"),f=o("conv64_1"),h=o("conv64_2"),p=o("conv64_3"),l=o("conv128_down"),d=o("conv128_1"),v=o("conv128_2"),m=o("conv256_down"),b=o("conv256_1"),g=o("conv256_2"),y=o("conv256_down_out"),w=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!_(w,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var x={conv32_down:i,conv32_1:a,conv32_2:c,conv32_3:s,conv64_down:u,conv64_1:f,conv64_2:h,conv64_3:p,conv128_down:l,conv128_1:d,conv128_2:v,conv256_down:m,conv256_1:b,conv256_2:g,conv256_down_out:y,fc:w};return St(t,e),{params:x,paramMappings:e}}function de(t,e){var n=function(t,e){return se(t,e,[1,1],!0)}(t,e.conv1);return n=ue(n,e.conv2),n=b.c(n,t),n=b.w(n)}function ve(t,e){var n=fe(t,e.conv1);n=ue(n,e.conv2);var r=b.d(t,2,2,"valid"),o=b.P(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=Object(y.e)(n.shape);a[1]=1;var c=b.P(a);n=b.h([n,c],1);var s=Object(y.e)(n.shape);s[2]=1;var u=b.P(s);n=b.h([n,u],2)}return r=i?b.h([r,o],3):r,n=b.c(r,n),n=b.w(n)}var me=function(t){function e(){return t.call(this,"FaceRecognitionNet")||this}return Object(y.c)(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceRecognitionNet - load model before inference");return b.L((function(){var n=fe(B(t.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(b.y(256)),e.conv32_down);n=de(n=b.s(n,3,2,"valid"),e.conv32_1),n=de(n,e.conv32_2),n=de(n,e.conv32_3),n=de(n=ve(n,e.conv64_down),e.conv64_1),n=de(n,e.conv64_2),n=de(n,e.conv64_3),n=de(n=ve(n,e.conv128_down),e.conv128_1),n=de(n,e.conv128_2),n=de(n=ve(n,e.conv256_down),e.conv256_1);var r=(n=ve(n=de(n,e.conv256_2),e.conv256_down_out)).mean([1,2]);return b.q(r,e.fc)}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.computeFaceDescriptor=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e,n,r,o=this;return Object(y.d)(this,(function(i){switch(i.label){case 0:return[4,bt(t)];case 1:return e=i.sent(),n=b.L((function(){return b.O(o.forwardInput(e))})),[4,Promise.all(n.map((function(t){return t.data()})))];case 2:return r=i.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return le(t)},e.prototype.extractParams=function(t){return function(t){var e=Rt(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=he(n,o),a=i.extractConvLayerParams,c=i.extractResidualLayerParams,s=a(4704,32,7,"conv32_down"),u=c(9216,32,3,"conv32_1"),f=c(9216,32,3,"conv32_2"),h=c(9216,32,3,"conv32_3"),p=c(36864,64,3,"conv64_down",!0),l=c(36864,64,3,"conv64_1"),d=c(36864,64,3,"conv64_2"),v=c(36864,64,3,"conv64_3"),m=c(147456,128,3,"conv128_down",!0),g=c(147456,128,3,"conv128_1"),y=c(147456,128,3,"conv128_2"),w=c(589824,256,3,"conv256_down",!0),_=c(589824,256,3,"conv256_1"),x=c(589824,256,3,"conv256_2"),P=c(589824,256,3,"conv256_down_out"),O=b.L((function(){return b.N(b.I(n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:s,conv32_1:u,conv32_2:f,conv32_3:h,conv64_down:p,conv64_1:l,conv64_2:d,conv64_3:v,conv128_down:m,conv128_1:g,conv128_2:y,conv256_down:w,conv256_1:_,conv256_2:x,conv256_down_out:P,fc:O},paramMappings:o}}(t)},e}(Ot);function be(t,e){var n={descriptor:e};return Object.assign({},t,n)}function ge(t,e){var n={age:e};return Object.assign({},t,n)}function ye(t,e,n){var r={gender:e,genderProbability:n};return Object.assign({},t,r)}var we=function(){function t(t){var e=void 0===t?{}:t,n=e.minFaceSize,r=e.scaleFactor,o=e.maxNumScales,i=e.scoreThresholds,a=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=a,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(t){return"number"!==typeof t})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(t){return"number"!==typeof t}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function _e(t,e){function n(n,r,o,i,a){var c=b.K(t(n*r*o*o),[o,o,n,r]),s=b.H(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/"+(a?"batch_norm_offset":"bias")}),{filters:c,bias:s}}function r(t,e,r,o){var i=n(t,e,r,o,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function o(n,o,i){return{depthwise_conv:function(n,r){var o=b.K(t(9*n),[3,3,n,1]),i=b.H(t(n)),a=b.H(t(n)),c=b.H(t(n)),s=b.H(t(n));return e.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:o,batch_norm_scale:i,batch_norm_offset:a,batch_norm_mean:c,batch_norm_variance:s}}(n,i+"/depthwise_conv"),pointwise_conv:r(n,o,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:o(32,64,"mobilenetv1/conv_1"),conv_2:o(64,128,"mobilenetv1/conv_2"),conv_3:o(128,128,"mobilenetv1/conv_3"),conv_4:o(128,256,"mobilenetv1/conv_4"),conv_5:o(256,256,"mobilenetv1/conv_5"),conv_6:o(256,512,"mobilenetv1/conv_6"),conv_7:o(512,512,"mobilenetv1/conv_7"),conv_8:o(512,512,"mobilenetv1/conv_8"),conv_9:o(512,512,"mobilenetv1/conv_9"),conv_10:o(512,512,"mobilenetv1/conv_10"),conv_11:o(512,512,"mobilenetv1/conv_11"),conv_12:o(512,1024,"mobilenetv1/conv_12"),conv_13:o(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function xe(t){var e=[],n=function(t,e){var n=Ct(t,e);function r(t,e,r){return{filters:n(t+"/Conv2d_"+e+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(t+"/Conv2d_"+e+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(t){var e="mobilenetv1/conv_"+t,o="MobilenetV1/Conv2d_"+t+"_depthwise",i=e+"/depthwise_conv",a=e+"/pointwise_conv";return{depthwise_conv:{filters:n(o+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(o+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(o+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(o+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(o+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",t,a)}}function i(t,e){return{filters:n(t+"/weights",4,e+"/filters"),bias:n(t+"/biases",1,e+"/bias")}}function a(t){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+t+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+t+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+t+"/ClassPredictor","prediction_layer/box_predictor_"+t+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!x(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return St(t,e),{params:a,paramMappings:e}}function Pe(t,e,n){return b.L((function(){var r=b.i(t,e.filters,n,"same");return r=b.c(r,e.batch_norm_offset),b.g(r,0,6)}))}function Oe(t,e){return b.L((function(){var n=null,r=Pe(t,e.conv_0,[2,2]);if([e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13].forEach((function(t,e){var o=e+1,i=function(t){return[2,4,6,12].some((function(e){return e===t}))?[2,2]:[1,1]}(o);r=Pe(r=function(t,e,n){return b.L((function(){var r=b.j(t,e.filters,n,"same");return r=b.e(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,.0010000000474974513),b.g(r,0,6)}))}(r,t.depthwise_conv,i),t.pointwise_conv,[1,1]),11===o&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}function Ee(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),c=Math.max(r[e][1],r[e][3]),s=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),f=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),p=(a-o)*(c-i),l=(f-s)*(h-u);if(p<=0||l<=0)return 0;var d=Math.max(o,s),v=Math.max(i,u),m=Math.min(a,f),b=Math.min(c,h),g=Math.max(m-d,0)*Math.max(b-v,0);return g/(p+l-g)}function je(t,e){var n=function(t){var e=b.O(b.N(t,[1,0])),n=[b.F(e[2],e[0]),b.F(e[3],e[1])];return{sizes:n,centers:[b.c(e[0],b.k(n[0],b.y(2))),b.c(e[1],b.k(n[1],b.y(2)))]}}(t),r=n.sizes,o=n.centers,i=b.O(b.N(e,[1,0])),a=b.k(b.t(b.l(b.k(i[2],b.y(5))),r[0]),b.y(2)),c=b.c(b.t(b.k(i[0],b.y(10)),r[0]),o[0]),s=b.k(b.t(b.l(b.k(i[3],b.y(5))),r[1]),b.y(2)),u=b.c(b.t(b.k(i[1],b.y(10)),r[1]),o[1]);return b.N(b.E([b.F(c,a),b.F(u,s),b.c(c,a),b.c(u,s)]),[1,0])}function Me(t,e){return b.L((function(){var n=t.shape[0];return{boxPredictionEncoding:b.x(Tt(t,e.box_encoding_predictor),[n,-1,1,4]),classPrediction:b.x(Tt(t,e.class_predictor),[n,-1,3])}}))}var Te=function(){function t(t){var e=void 0===t?{}:t,n=e.minConfidence,r=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),Se=function(t){function e(){return t.call(this,"SsdMobilenetv1")||this}return Object(y.c)(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("SsdMobilenetv1 - load model before inference");return b.L((function(){var n=t.toBatchTensor(512,!1).toFloat(),r=Oe(b.F(b.t(n,b.y(.007843137718737125)),b.y(1)),e.mobilenetv1),o=function(t,e,n){return b.L((function(){var r=Pe(t,n.conv_0,[1,1]),o=Pe(r,n.conv_1,[2,2]),i=Pe(o,n.conv_2,[1,1]),a=Pe(i,n.conv_3,[2,2]),c=Pe(a,n.conv_4,[1,1]),s=Pe(c,n.conv_5,[2,2]),u=Pe(s,n.conv_6,[1,1]),f=Pe(u,n.conv_7,[2,2]),h=Me(e,n.box_predictor_0),p=Me(t,n.box_predictor_1),l=Me(o,n.box_predictor_2),d=Me(a,n.box_predictor_3),v=Me(s,n.box_predictor_4),m=Me(f,n.box_predictor_5);return{boxPredictions:b.h([h.boxPredictionEncoding,p.boxPredictionEncoding,l.boxPredictionEncoding,d.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding],1),classPredictions:b.h([h.classPrediction,p.classPrediction,l.classPrediction,d.classPrediction,v.classPrediction,m.classPrediction],1)}}))}(r.out,r.conv11,e.prediction_layer);return function(t,e,n){return b.L((function(){var r=t.shape[0],o=je(b.x(b.M(n.extra_dim,[r,1,1]),[-1,4]),b.x(t,[-1,4]));o=b.x(o,[r,o.shape[0]/r,4]);var i=b.A(b.B(e,[0,0,1],[-1,-1,-1])),a=b.B(i,[0,0,0],[-1,-1,1]);return a=b.x(a,[r,a.shape[1]]),{boxes:b.O(o),scores:b.O(a)}}))}(o.boxPredictions,o.classPredictions,e.output_layer)}))},e.prototype.forward=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,bt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.locateFaces=function(t,e){return void 0===e&&(e={}),Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i,a,c,s,u,f,h,p,l,d,v,m,b,g,w,_,x;return Object(y.d)(this,(function(y){switch(y.label){case 0:return n=new Te(e),r=n.maxResults,o=n.minConfidence,[4,bt(t)];case 1:for(i=y.sent(),a=this.forwardInput(i),c=a.boxes,s=a.scores,u=c[0],f=s[0],h=1;h<c.length;h++)c[h].dispose(),s[h].dispose();return d=(l=Array).from,[4,f.data()];case 2:return p=d.apply(l,[y.sent()]),.5,v=function(t,e,n,r,o){var i=t.shape[0],a=Math.min(n,i),c=e.map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>o})).sort((function(t,e){return e.score-t.score})),s=[];return c.forEach((function(e){if(!(s.length>=a)){for(var n=e.score,i=s.length-1;i>=0;--i){var c=Ee(t,e.boxIndex,s[i]);if(0!==c&&(e.score*=c<=r?1:0,e.score<=o))break}n===e.score&&s.push(e.boxIndex)}})),s}(u,p,r,.5,o),m=i.getReshapedInputDimensions(0),b=i.inputSize,g=b/m.width,w=b/m.height,_=u.arraySync(),x=v.map((function(t){var e=[Math.max(0,_[t][0]),Math.min(1,_[t][2])].map((function(t){return t*w})),n=e[0],r=e[1],o=[Math.max(0,_[t][1]),Math.min(1,_[t][3])].map((function(t){return t*g})),a=o[0],c=o[1];return new C(p[t],new W(a,n,c-a,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})})),u.dispose(),f.dispose(),[2,x]}}))}))},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return xe(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=Rt(t),r=n.extractWeights,o=n.getRemainingWeights,i=_e(r,e),a=i.extractMobilenetV1Params,c=i.extractPredictionLayerParams,s=a(),u=c(),f={extra_dim:b.J(r(20472),[1,5118,4])};if(e.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:s,prediction_layer:u,output_layer:f},paramMappings:e}}(t)},e}(Ot);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(y.c)(e,t)}(Se);var Ae,Le=[new L(.738768,.874946),new L(2.42204,2.65704),new L(4.30971,7.04493),new L(10.246,4.59428),new L(12.6868,11.8741)],De=[new L(1.603231,2.094468),new L(6.041143,7.080126),new L(2.882459,3.518061),new L(4.266906,5.178857),new L(9.041765,10.66308)],Ie=[117.001,114.697,97.404],Fe=function(t){return"number"===typeof t};function Ce(t){return b.L((function(){var e=b.t(t,b.y(.10000000149011612));return b.c(b.w(b.F(t,e)),e)}))}function Re(t,e){return b.L((function(){var n=b.v(t,[[0,0],[1,1],[1,1],[0,0]]);return n=b.i(n,e.conv.filters,[1,1],"valid"),n=b.F(n,e.bn.sub),n=b.t(n,e.bn.truediv),Ce(n=b.c(n,e.conv.bias))}))}function ke(t,e){return b.L((function(){var n=b.v(t,[[0,0],[1,1],[1,1],[0,0]]);return n=b.z(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),Ce(n=b.c(n,e.bias))}))}function Be(t,e){var n=At(t,e);var r=It(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,o,i){return{conv:n(r,o,3,i+"/conv"),bn:function(n,r){var o=b.H(t(n)),i=b.H(t(n));return e.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:o,truediv:i}}(o,i+"/bn")}},extractSeparableConvParams:r}}function Ne(t,e){var n=Ct(t,e);function r(t){return{filters:n(t+"/filters",4),bias:n(t+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(t){return{conv:r(t+"/conv"),bn:function(t){return{sub:n(t+"/sub",1),truediv:n(t+"/truediv",1)}}(t+"/bn")}},extractSeparableConvParams:Ft(n)}}!function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"}(Ae||(Ae={}));var We=function(){function t(t){var e=void 0===t?{}:t,n=e.inputSize,r=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),ze=function(t){function e(e){var n=t.call(this,"TinyYolov2")||this;return function(t){if(!t)throw new Error("invalid config: "+t);if("boolean"!==typeof t.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!Fe(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every((function(t){return"string"===typeof t})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map((function(t){return t||{}})).every((function(t){return Fe(t.x)&&Fe(t.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every(Fe)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}(e),n._config=e,n}return Object(y.c)(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,e){var n=Re(t,e.conv0);return n=Re(n=b.s(n,[2,2],[2,2],"same"),e.conv1),n=Re(n=b.s(n,[2,2],[2,2],"same"),e.conv2),n=Re(n=b.s(n,[2,2],[2,2],"same"),e.conv3),n=Re(n=b.s(n,[2,2],[2,2],"same"),e.conv4),n=Re(n=b.s(n,[2,2],[2,2],"same"),e.conv5),n=Re(n=b.s(n,[2,2],[1,1],"same"),e.conv6),Tt(n=Re(n,e.conv7),e.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,e){var n=this.config.isFirstLayerConv2d?Ce(Tt(t,e.conv0,"valid",!1)):ke(t,e.conv0);return n=ke(n=b.s(n,[2,2],[2,2],"same"),e.conv1),n=ke(n=b.s(n,[2,2],[2,2],"same"),e.conv2),n=ke(n=b.s(n,[2,2],[2,2],"same"),e.conv3),n=ke(n=b.s(n,[2,2],[2,2],"same"),e.conv4),n=ke(n=b.s(n,[2,2],[2,2],"same"),e.conv5),n=b.s(n,[2,2],[1,1],"same"),n=e.conv6?ke(n,e.conv6):n,Tt(n=e.conv7?ke(n,e.conv7):n,e.conv8,"valid",!1)},e.prototype.forwardInput=function(t,e){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return b.L((function(){var o=t.toBatchTensor(e,!1).toFloat();return o=(o=n.config.meanRgb?B(o,n.config.meanRgb):o).div(b.y(256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)}))},e.prototype.forward=function(t,e){return Object(y.b)(this,void 0,void 0,(function(){var n;return Object(y.d)(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,bt(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent()]}}))}))},e.prototype.detect=function(t,e){return void 0===e&&(e={}),Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i,a,c,s,u,f,h,p,l,d,v=this;return Object(y.d)(this,(function(m){switch(m.label){case 0:return n=new We(e),r=n.inputSize,o=n.scoreThreshold,[4,bt(t)];case 1:return i=m.sent(),[4,this.forwardInput(i,r)];case 2:return a=m.sent(),c=b.L((function(){return b.O(a)[0].expandDims()})),s={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(c,i.getReshapedInputDimensions(0),o)];case 3:return u=m.sent(),a.dispose(),c.dispose(),f=u.map((function(t){return t.box})),h=u.map((function(t){return t.score})),p=u.map((function(t){return t.classScore})),l=u.map((function(t){return v.config.classes[t.label]})),d=k(f.map((function(t){return t.rescale(r)})),h,this.config.iouThreshold,!0),[2,d.map((function(t){return new F(h[t],p[t],l[t],f[t],s)}))]}}))}))},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r=[],o=Ne(t,r),i=o.extractConvParams,a=o.extractConvWithBatchNormParams,c=o.extractSeparableConvParams;if(e.withSeparableConvs){var s=e.filterSizes&&e.filterSizes.length||9;n={conv0:e.isFirstLayerConv2d?i("conv0"):c("conv0"),conv1:c("conv1"),conv2:c("conv2"),conv3:c("conv3"),conv4:c("conv4"),conv5:c("conv5"),conv6:s>7?c("conv6"):void 0,conv7:s>8?c("conv7"):void 0,conv8:i("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:i("conv8")};return St(t,r),{params:n,paramMappings:r}}(t,this.config)},e.prototype.extractParams=function(t){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(t,e,n,r){var o,i=Rt(t),a=i.extractWeights,c=i.getRemainingWeights,s=[],u=Be(a,s),f=u.extractConvParams,h=u.extractConvWithBatchNormParams,p=u.extractSeparableConvParams;if(e.withSeparableConvs){var l=r[0],d=r[1],v=r[2],m=r[3],b=r[4],g=r[5],y=r[6],w=r[7],_=r[8];o={conv0:e.isFirstLayerConv2d?f(l,d,3,"conv0"):p(l,d,"conv0"),conv1:p(d,v,"conv1"),conv2:p(v,m,"conv2"),conv3:p(m,b,"conv3"),conv4:p(b,g,"conv4"),conv5:p(g,y,"conv5"),conv6:w?p(y,w,"conv6"):void 0,conv7:_?p(w,_,"conv7"):void 0,conv8:f(_||w||y,5*n,1,"conv8")}}else l=r[0],d=r[1],v=r[2],m=r[3],b=r[4],g=r[5],y=r[6],w=r[7],_=r[8],o={conv0:h(l,d,"conv0"),conv1:h(d,v,"conv1"),conv2:h(v,m,"conv2"),conv3:h(m,b,"conv3"),conv4:h(b,g,"conv4"),conv5:h(g,y,"conv5"),conv6:h(y,w,"conv6"),conv7:h(w,_,"conv7"),conv8:f(_,5*n,1,"conv8")};if(0!==c().length)throw new Error("weights remaing after extract: "+c().length);return{params:o,paramMappings:s}}(t,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(t,e,n){return Object(y.b)(this,void 0,void 0,(function(){var r,o,i,a,c,s,u,f,h,p,l,d,v,m,g,w,_,x,P,O,E,j,M,T,S,A,L,D,F,C=this;return Object(y.d)(this,(function(R){switch(R.label){case 0:return r=e.width,o=e.height,i=Math.max(r,o),a=i/r,c=i/o,s=t.shape[1],u=this.config.anchors.length,f=b.L((function(){var e=t.reshape([s,s,u,C.boxEncodingSize]);return[e.slice([0,0,0,0],[s,s,u,4]),e.slice([0,0,0,4],[s,s,u,1]),C.withClassScores?b.D(e.slice([0,0,0,5],[s,s,u,C.config.classes.length]),3):b.y(0)]})),h=f[0],p=f[1],l=f[2],d=[],[4,p.array()];case 1:return v=R.sent(),[4,h.array()];case 2:m=R.sent(),g=0,R.label=3;case 3:if(!(g<s))return[3,12];w=0,R.label=4;case 4:if(!(w<s))return[3,11];_=0,R.label=5;case 5:return _<u?(x=N(v[g][w][_][0]),!n||x>n?(P=(w+N(m[g][w][_][0]))/s*a,O=(g+N(m[g][w][_][1]))/s*c,E=Math.exp(m[g][w][_][2])*this.config.anchors[_].x/s*a,j=Math.exp(m[g][w][_][3])*this.config.anchors[_].y/s*c,M=P-E/2,T=O-j/2,S={row:g,col:w,anchor:_},this.withClassScores?[4,this.extractPredictedClass(l,S)]:[3,7]):[3,9]):[3,10];case 6:return F=R.sent(),[3,8];case 7:F={classScore:1,label:0},R.label=8;case 8:L=(A=F).classScore,D=A.label,d.push(Object(y.a)({box:new I(M,T,M+E,T+j),score:x,classScore:x*L,label:D},S)),R.label=9;case 9:return _++,[3,5];case 10:return w++,[3,4];case 11:return g++,[3,3];case 12:return h.dispose(),p.dispose(),l.dispose(),[2,d]}}))}))},e.prototype.extractPredictedClass=function(t,e){return Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i;return Object(y.d)(this,(function(a){switch(a.label){case 0:return n=e.row,r=e.col,o=e.anchor,[4,t.array()];case 1:return i=a.sent(),[2,Array(this.config.classes.length).fill(0).map((function(t,e){return i[n][r][o][e]})).map((function(t,e){return{classScore:t,label:e}})).reduce((function(t,e){return t.classScore>e.classScore?t:e}))]}}))}))},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(Ot),Ue=function(t){function e(e){void 0===e&&(e=!0);var n=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:De,meanRgb:Ie}:{anchors:Le,withClassScores:!0});return t.call(this,n)||this}return Object(y.c)(e,t),Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map((function(t){return new C(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(ze);var Ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return Object(y.c)(e,t),e}(We),He=function(){function t(){}return t.prototype.then=function(t){return Object(y.b)(this,void 0,void 0,(function(){var e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}}))}))},t.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(t){throw new Error("ComposableTask - run is not implemented")}))}))},t}();function Ge(t,e,n,r,o){return void 0===o&&(o=function(t){return t.alignedRect}),Object(y.b)(this,void 0,void 0,(function(){var i,a,c,s,u;return Object(y.d)(this,(function(f){switch(f.label){case 0:return i=t.map((function(t){return Jt(t)?o(t):t.detection})),(c=r)?[3,5]:e instanceof b.a?[4,yt(e,i)]:[3,2];case 1:return s=f.sent(),[3,4];case 2:return[4,gt(e,i)];case 3:s=f.sent(),f.label=4;case 4:c=s,f.label=5;case 5:return[4,n(a=c)];case 6:return u=f.sent(),a.forEach((function(t){return t instanceof b.a&&t.dispose()})),[2,u]}}))}))}function qe(t,e,n,r,o){return Object(y.b)(this,void 0,void 0,(function(){var i=this;return Object(y.d)(this,(function(a){return[2,Ge([t],e,(function(t){return Object(y.b)(i,void 0,void 0,(function(){return Object(y.d)(this,(function(e){return[2,n(t[0])]}))}))}),r,o)]}))}))}function Ve(t){var e=Rt(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=function(t,e){var n=At(t,e),r=Lt(t,e);function o(n,r){var o=b.H(t(n));return e.push({paramPath:r}),o}function i(t,e,r){return void 0===r&&(r=!1),{conv1:n(t[0],t[1],3,e+"/conv1"),prelu1_alpha:o(t[1],e+"/prelu1_alpha"),conv2:n(t[1],t[2],3,e+"/conv2"),prelu2_alpha:o(t[2],e+"/prelu2_alpha"),conv3:n(t[2],t[3],r?2:3,e+"/conv3"),prelu3_alpha:o(t[3],e+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=i([3,10,16,32],"pnet"),e=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return Object(y.a)(Object(y.a)({},t),{conv4_1:e,conv4_2:r})},extractRNetParams:function(){var t=i([3,28,48,64],"rnet",!0),e=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),c=r(128,4,"rnet/fc2_2");return Object(y.a)(Object(y.a)({},t),{fc1:e,prelu4_alpha:n,fc2_1:a,fc2_2:c})},extractONetParams:function(){var t=i([3,32,64,64],"onet"),e=n(64,128,2,"onet/conv4"),a=o(128,"onet/prelu4_alpha"),c=r(1152,256,"onet/fc1"),s=o(256,"onet/prelu5_alpha"),u=r(256,2,"onet/fc2_1"),f=r(256,4,"onet/fc2_2"),h=r(256,10,"onet/fc2_3");return Object(y.a)(Object(y.a)({},t),{conv4:e,prelu4_alpha:a,fc1:c,prelu5_alpha:s,fc2_1:u,fc2_2:f,fc2_3:h})}}}(n,o),a=i.extractPNetParams,c=i.extractRNetParams,s=i.extractONetParams,u=a(),f=c(),h=s();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:u,rnet:f,onet:h},paramMappings:o}}function Je(t){var e=[],n=function(t,e){var n=Ct(t,e);function r(t){return{filters:n(t+"/weights",4,t+"/filters"),bias:n(t+"/bias",1)}}function o(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}function i(t){return n(t,1)}function a(t){return{conv1:r(t+"/conv1"),prelu1_alpha:i(t+"/prelu1_alpha"),conv2:r(t+"/conv2"),prelu2_alpha:i(t+"/prelu2_alpha"),conv3:r(t+"/conv3"),prelu3_alpha:i(t+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=a("pnet"),e=r("pnet/conv4_1"),n=r("pnet/conv4_2");return Object(y.a)(Object(y.a)({},t),{conv4_1:e,conv4_2:n})},extractRNetParams:function(){var t=a("rnet"),e=o("rnet/fc1"),n=i("rnet/prelu4_alpha"),r=o("rnet/fc2_1"),c=o("rnet/fc2_2");return Object(y.a)(Object(y.a)({},t),{fc1:e,prelu4_alpha:n,fc2_1:r,fc2_2:c})},extractONetParams:function(){var t=a("onet"),e=r("onet/conv4"),n=i("onet/prelu4_alpha"),c=o("onet/fc1"),s=i("onet/prelu5_alpha"),u=o("onet/fc2_1"),f=o("onet/fc2_2"),h=o("onet/fc2_3");return Object(y.a)(Object(y.a)({},t),{conv4:e,prelu4_alpha:n,fc1:c,prelu5_alpha:s,fc2_1:u,fc2_2:f,fc2_3:h})}}}(t,e),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),c=o(),s=i();return St(t,e),{params:{pnet:a,rnet:c,onet:s},paramMappings:e}}function Xe(t,e){var n=e[0],r=e[1];return{height:Math.floor(n*t),width:Math.floor(r*t)}}var Ke=function(t){function e(e,n,r,o){return t.call(this,{left:e,top:n,right:r,bottom:o},!0)||this}return Object(y.c)(e,t),e}(D);function Ze(t){return b.L((function(){return b.t(b.F(t,b.y(127.5)),b.y(.0078125))}))}function $e(t,e){return b.L((function(){return b.c(b.w(t),b.t(e,b.u(b.w(b.u(t)))))}))}function Qe(t,e,n){return void 0===n&&(n=!1),b.L((function(){var r=Tt(t,e.conv1,"valid");return r=$e(r,e.prelu1_alpha),r=$e(r=Tt(r=b.s(r,n?[2,2]:[3,3],[2,2],"same"),e.conv2,"valid"),e.prelu2_alpha),r=$e(r=Tt(r=n?r:b.s(r,[3,3],[2,2],"valid"),e.conv3,"valid"),e.prelu3_alpha)}))}function tn(t,e,n,r,o){o.stage1=[];var i=e.map((function(e){return b.L((function(){var n={scale:e},o=function(t,e){return b.L((function(){var n=Xe(e,t.shape.slice(1)),r=n.height,o=n.width,i=Ze(b.o.resizeBilinear(t,[r,o]));return b.N(i,[0,2,1,3])}))}(t,e),i=Date.now(),a=function(t,e){return b.L((function(){var n=Qe(t,e,!0),r=Tt(n,e.conv4_1,"valid"),o=b.m(b.r(r,3),3);return{prob:b.D(b.F(r,o),3),regions:Tt(n,e.conv4_2,"valid")}}))}(o,r),c=a.prob,s=a.regions;return n.pnet=Date.now()-i,{scoresTensor:b.O(b.O(c,3)[1])[0],regionsTensor:b.O(s)[0],scale:e,statsForScale:n}}))})).map((function(t){var e=t.scoresTensor,r=t.regionsTensor,i=t.scale,a=t.statsForScale,c=function(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var c=0;c<t.shape[1];c++)i[a][c]>=r&&o.push(new L(c,a));return o.map((function(t){var r=new I(Math.round((2*t.y+1)/n),Math.round((2*t.x+1)/n),Math.round((2*t.y+12)/n),Math.round((2*t.x+12)/n)),o=i[t.y][t.x],a=e.arraySync();return{cell:r,score:o,region:new Ke(a[t.y][t.x][0],a[t.y][t.x][1],a[t.y][t.x][2],a[t.y][t.x][3])}}))}(e,r,i,n);if(e.dispose(),r.dispose(),!c.length)return o.stage1.push(a),[];var s=Date.now(),u=k(c.map((function(t){return t.cell})),c.map((function(t){return t.score})),.5);return a.nms=Date.now()-s,a.numBoxes=u.length,o.stage1.push(a),u.map((function(t){return c[t]}))})).reduce((function(t,e){return t.concat(e)}),[]),a=[],c=[];if(i.length>0){var s=Date.now(),u=k(i.map((function(t){return t.cell})),i.map((function(t){return t.score})),.7);o.stage1_nms=Date.now()-s,c=u.map((function(t){return i[t].score})),a=u.map((function(t){return i[t]})).map((function(t){var e=t.cell,n=t.region;return new I(e.left+n.left*e.width,e.top+n.top*e.height,e.right+n.right*e.width,e.bottom+n.bottom*e.height).toSquare().round()}))}return{boxes:a,scores:c}}function en(t,e,n){var r=n.width,o=n.height;return Object(y.b)(this,void 0,void 0,(function(){var n,i,a,c=this;return Object(y.d)(this,(function(s){switch(s.label){case 0:return n=at(t),[4,Promise.all(e.map((function(e){return Object(y.b)(c,void 0,void 0,(function(){var r,o,i,a,c,s,u,f;return Object(y.d)(this,(function(h){return r=e.padAtBorders(t.height,t.width),o=r.y,i=r.ey,a=r.x,c=r.ex,s=a-1,u=o-1,f=n.getImageData(s,u,c-s,i-u),[2,ot.isNodejs()?lt(f):createImageBitmap(f)]}))}))})))];case 1:return i=s.sent(),a=[],i.forEach((function(t){var e=at(pt({width:r,height:o}));e.drawImage(t,0,0,r,o);for(var n=e.getImageData(0,0,r,o).data,i=[],c=0;c<n.length;c+=4)i.push(n[c+2]),i.push(n[c+1]),i.push(n[c]);a.push(i)})),[2,a.map((function(t){return b.L((function(){return Ze(b.N(b.K(t,[1,r,o,3]),[0,2,1,3]).toFloat())}))}))]}}))}))}function nn(t,e,n,r,o){return Object(y.b)(this,void 0,void 0,(function(){var i,a,c,s,u,f,h,p,l,d,v,m,g,w;return Object(y.d)(this,(function(y){switch(y.label){case 0:return i=Date.now(),[4,en(t,e,{width:24,height:24})];case 1:return a=y.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),c=a.map((function(t){var e=function(t,e){return b.L((function(){var n=Qe(t,e),r=$e(zt(b.x(n,[n.shape[0],e.fc1.weights.shape[0]]),e.fc1),e.prelu4_alpha),o=zt(r,e.fc2_1),i=b.m(b.r(o,1),1),a=b.D(b.F(o,i),1),c=zt(r,e.fc2_2);return{scores:b.O(a,1)[1],regions:c}}))}(t,r);return t.dispose(),e})),o.stage2_rnet=Date.now()-i,s=c.length>1?b.h(c.map((function(t){return t.scores}))):c[0].scores,h=(f=Array).from,[4,s.data()];case 2:return u=h.apply(f,[y.sent()]),s.dispose(),p=u.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){return t.idx})),l=p.map((function(t){return e[t]})),d=p.map((function(t){return u[t]})),v=[],m=[],l.length>0&&(i=Date.now(),g=k(l,d,.7),o.stage2_nms=Date.now()-i,w=g.map((function(t){var e=c[p[t]].regions.arraySync();return new Ke(e[0][0],e[0][1],e[0][2],e[0][3])})),m=g.map((function(t){return d[t]})),v=g.map((function(t,e){return l[t].calibrate(w[e])}))),c.forEach((function(t){t.regions.dispose(),t.scores.dispose()})),[2,{boxes:v,scores:m}]}}))}))}function rn(t,e,n,r,o){return Object(y.b)(this,void 0,void 0,(function(){var i,a,c,s,u,f,h,p,l,d,v,m,g,w,_;return Object(y.d)(this,(function(y){switch(y.label){case 0:return i=Date.now(),[4,en(t,e,{width:48,height:48})];case 1:return a=y.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),c=a.map((function(t){var e=function(t,e){return b.L((function(){var n=Qe(t,e);n=$e(n=Tt(n=b.s(n,[2,2],[2,2],"same"),e.conv4,"valid"),e.prelu4_alpha);var r=$e(zt(b.x(n,[n.shape[0],e.fc1.weights.shape[0]]),e.fc1),e.prelu5_alpha),o=zt(r,e.fc2_1),i=b.m(b.r(o,1),1),a=b.D(b.F(o,i),1),c=zt(r,e.fc2_2),s=zt(r,e.fc2_3);return{scores:b.O(a,1)[1],regions:c,points:s}}))}(t,r);return t.dispose(),e})),o.stage3_onet=Date.now()-i,s=c.length>1?b.h(c.map((function(t){return t.scores}))):c[0].scores,h=(f=Array).from,[4,s.data()];case 2:return u=h.apply(f,[y.sent()]),s.dispose(),p=u.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){return t.idx})),l=p.map((function(t){var e=c[t].regions.arraySync();return new Ke(e[0][0],e[0][1],e[0][2],e[0][3])})),d=p.map((function(t,n){return e[t].calibrate(l[n])})),v=p.map((function(t){return u[t]})),m=[],g=[],w=[],d.length>0&&(i=Date.now(),_=k(d,v,.7,!1),o.stage3_nms=Date.now()-i,m=_.map((function(t){return d[t]})),g=_.map((function(t){return v[t]})),w=_.map((function(t,e){return Array(5).fill(0).map((function(n,r){var o=c[t].points.arraySync();return new L(o[0][r]*(m[e].width+1)+m[e].left,o[0][r+5]*(m[e].height+1)+m[e].top)}))}))),c.forEach((function(t){t.regions.dispose(),t.scores.dispose(),t.points.dispose()})),[2,{boxes:m,scores:g,points:w}]}}))}))}var on=function(t){function e(){return t.call(this,"Mtcnn")||this}return Object(y.c)(e,t),e.prototype.load=function(e){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,e)]}))}))},e.prototype.loadFromDisk=function(e){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,e)]}))}))},e.prototype.forwardInput=function(t,e){return void 0===e&&(e={}),Object(y.b)(this,void 0,void 0,(function(){var n,r,o,i,a,c,s,u,f,h,p,l,d,v,m,g,w,_,x,P,O;return Object(y.d)(this,(function(y){switch(y.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=t.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},i=Date.now(),a=b.L((function(){return t=b.m(b.f.fromPixels(r)).toFloat(),b.L((function(){return b.E(b.O(t,3).reverse(),3)}));var t})),c=function(t){return a.dispose(),o.total=Date.now()-i,t},s=a.shape.slice(1),u=s[0],f=s[1],h=new we(e),p=h.minFaceSize,l=h.scaleFactor,d=h.maxNumScales,v=h.scoreThresholds,m=h.scaleSteps,g=(m||function(t,e,n){for(var r=n[0],o=n[1],i=12/t,a=[],c=Math.min(r,o)*i,s=0;c>=12;)a.push(i*Math.pow(e,s)),c*=e,s+=1;return a}(p,l,[u,f])).filter((function(t){var e=Xe(t,[u,f]);return Math.min(e.width,e.height)>12})).slice(0,d),o.scales=g,o.pyramid=g.map((function(t){return Xe(t,[u,f])})),w=Date.now(),[4,tn(a,g,v[0],n.pnet,o)];case 1:return _=y.sent(),o.total_stage1=Date.now()-w,_.boxes.length?(o.stage2_numInputBoxes=_.boxes.length,w=Date.now(),[4,nn(r,_.boxes,v[1],n.rnet,o)]):[2,c({results:[],stats:o})];case 2:return x=y.sent(),o.total_stage2=Date.now()-w,x.boxes.length?(o.stage3_numInputBoxes=x.boxes.length,w=Date.now(),[4,rn(r,x.boxes,v[2],n.onet,o)]):[2,c({results:[],stats:o})];case 3:return P=y.sent(),o.total_stage3=Date.now()-w,O=P.boxes.map((function(t,e){return Xt(J({},new C(P.scores[e],new W(t.left/f,t.top/u,t.width/f,t.height/u),{height:u,width:f})),new U(P.points[e].map((function(e){return e.sub(new L(t.left,t.top)).div(new L(t.width,t.height))})),{width:t.width,height:t.height}))})),[2,c({results:O,stats:o})]}}))}))},e.prototype.forward=function(t,e){return void 0===e&&(e={}),Object(y.b)(this,void 0,void 0,(function(){var n;return Object(y.d)(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,bt(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent().results]}}))}))},e.prototype.forwardWithStats=function(t,e){return void 0===e&&(e={}),Object(y.b)(this,void 0,void 0,(function(){var n;return Object(y.d)(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,bt(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}}))}))},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return Je(t)},e.prototype.extractParams=function(t){return Ve(t)},e}(Ot),an=[new L(1.603231,2.094468),new L(6.041143,7.080126),new L(2.882459,3.518061),new L(4.266906,5.178857),new L(9.041765,10.66308)],cn=[117.001,114.697,97.404],sn=function(t){function e(){var e={withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:an,meanRgb:cn,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return t.call(this,e)||this}return Object(y.c)(e,t),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return Object(y.b)(this,void 0,void 0,(function(){return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map((function(t){return new C(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(ze),un={ssdMobilenetv1:new Se,tinyFaceDetector:new sn,tinyYolov2:new Ue,mtcnn:new on,faceLandmark68Net:new ie,faceLandmark68TinyNet:new ce,faceRecognitionNet:new me,faceExpressionNet:new qt,ageGenderNet:new re},fn=function(t){return un.ssdMobilenetv1.load(t)},hn=function(t){return un.faceLandmark68Net.load(t)},pn=function(t){return un.faceRecognitionNet.load(t)},ln=function(t){return un.faceExpressionNet.load(t)},dn=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=r,o}return Object(y.c)(e,t),e}(He),vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e,n=this;return Object(y.d)(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Ge(t=r.sent(),this.input,(function(t){return Object(y.b)(n,void 0,void 0,(function(){return Object(y.d)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return un.faceExpressionNet.predictExpressions(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){return Vt(t,e[n])}))]}}))}))},e.prototype.withAgeAndGender=function(){return new wn(this,this.input)},e}(dn),mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(t=n.sent())?[4,qe(t,this.input,(function(t){return un.faceExpressionNet.predictExpressions(t)}),this.extractedFaces)]:[2];case 2:return e=n.sent(),[2,Vt(t,e)]}}))}))},e.prototype.withAgeAndGender=function(){return new _n(this,this.input)},e}(dn),bn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.withAgeAndGender=function(){return new xn(this,this.input)},e.prototype.withFaceDescriptors=function(){return new En(this,this.input)},e}(vn),gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.withAgeAndGender=function(){return new Pn(this,this.input)},e.prototype.withFaceDescriptor=function(){return new jn(this,this.input)},e}(mn),yn=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=r,o}return Object(y.c)(e,t),e}(He),wn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e,n=this;return Object(y.d)(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Ge(t=r.sent(),this.input,(function(t){return Object(y.b)(n,void 0,void 0,(function(){return Object(y.d)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return un.ageGenderNet.predictAgeAndGender(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){var r=e[n],o=r.age;return ge(ye(t,r.gender,r.genderProbability),o)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new vn(this,this.input)},e}(yn),_n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e,n,r,o;return Object(y.d)(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(t=i.sent())?[4,qe(t,this.input,(function(t){return un.ageGenderNet.predictAgeAndGender(t)}),this.extractedFaces)]:[2];case 2:return e=i.sent(),n=e.age,r=e.gender,o=e.genderProbability,[2,ge(ye(t,r,o),n)]}}))}))},e.prototype.withFaceExpressions=function(){return new mn(this,this.input)},e}(yn),xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.withFaceExpressions=function(){return new bn(this,this.input)},e.prototype.withFaceDescriptors=function(){return new En(this,this.input)},e}(wn),Pn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.withFaceExpressions=function(){return new gn(this,this.input)},e.prototype.withFaceDescriptor=function(){return new jn(this,this.input)},e}(_n),On=function(t){function e(e,n){var r=t.call(this)||this;return r.parentTask=e,r.input=n,r}return Object(y.c)(e,t),e}(He),En=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t;return Object(y.d)(this,(function(e){switch(e.label){case 0:return[4,this.parentTask];case 1:return[4,Ge(t=e.sent(),this.input,(function(t){return Promise.all(t.map((function(t){return un.faceRecognitionNet.computeFaceDescriptor(t)})))}),null,(function(t){return t.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return[2,e.sent().map((function(e,n){return be(t[n],e)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new bn(this,this.input)},e.prototype.withAgeAndGender=function(){return new xn(this,this.input)},e}(On),jn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(t=n.sent())?[4,qe(t,this.input,(function(t){return un.faceRecognitionNet.computeFaceDescriptor(t)}),null,(function(t){return t.landmarks.align(null,{useDlibAlignment:!0})}))]:[2];case 2:return e=n.sent(),[2,be(t,e)]}}))}))},e.prototype.withFaceExpressions=function(){return new gn(this,this.input)},e.prototype.withAgeAndGender=function(){return new Pn(this,this.input)},e}(On),Mn=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.useTinyLandmarkNet=r,o}return Object(y.c)(e,t),Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?un.faceLandmark68TinyNet:un.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(He),Tn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e,n,r,o,i=this;return Object(y.d)(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),e=t.map((function(t){return t.detection})),this.input instanceof b.a?[4,yt(this.input,e)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,gt(this.input,e)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map((function(t){return i.landmarkNet.detectLandmarks(t)})))];case 6:return o=a.sent(),n.forEach((function(t){return t instanceof b.a&&t.dispose()})),[2,t.map((function(t,e){return Xt(t,o[e])}))]}}))}))},e.prototype.withFaceExpressions=function(){return new bn(this,this.input)},e.prototype.withAgeAndGender=function(){return new xn(this,this.input)},e.prototype.withFaceDescriptors=function(){return new En(this,this.input)},e}(Mn),Sn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e,n,r,o;return Object(y.d)(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(t=i.sent())?(e=t.detection,this.input instanceof b.a?[4,yt(this.input,[e])]:[3,3]):[2];case 2:return r=i.sent(),[3,5];case 3:return[4,gt(this.input,[e])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=i.sent(),n.forEach((function(t){return t instanceof b.a&&t.dispose()})),[2,Xt(t,o)]}}))}))},e.prototype.withFaceExpressions=function(){return new gn(this,this.input)},e.prototype.withAgeAndGender=function(){return new Pn(this,this.input)},e.prototype.withFaceDescriptor=function(){return new jn(this,this.input)},e}(Mn),An=function(t){function e(e,n){void 0===n&&(n=new Te);var r=t.call(this)||this;return r.input=e,r.options=n,r}return Object(y.c)(e,t),e}(He),Ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e,n,r;return Object(y.d)(this,(function(o){switch(o.label){case 0:return e=(t=this).input,(n=t.options)instanceof we?[4,un.mtcnn.forward(e,n)]:[3,2];case 1:return[2,o.sent().map((function(t){return t.detection}))];case 2:if(!(r=n instanceof Ye?function(t){return un.tinyFaceDetector.locateFaces(t,n)}:n instanceof Te?function(t){return un.ssdMobilenetv1.locateFaces(t,n)}:n instanceof We?function(t){return un.tinyYolov2.locateFaces(t,n)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(e)]}}))}))},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise((function(e){return Object(y.b)(t,void 0,void 0,(function(){var t;return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return t=n.sent(),[2,e(t.map((function(t){return J({},t)})))]}}))}))}))},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new Tn(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new vn(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new wn(this.runAndExtendWithFaceDetections(),this.input)},e}(An);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(y.c)(e,t),e.prototype.run=function(){return Object(y.b)(this,void 0,void 0,(function(){var t,e;return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,new Ln(this.input,this.options)];case 1:return t=n.sent(),e=t[0],t.forEach((function(t){t.score>e.score&&(e=t)})),[2,e]}}))}))},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise((function(e){return Object(y.b)(t,void 0,void 0,(function(){var t;return Object(y.d)(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return t=n.sent(),[2,e(t?J({},t):void 0)]}}))}))}))},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new Sn(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new mn(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new _n(this.runAndExtendWithFaceDetection(),this.input)}}(An);function Dn(t,e){return void 0===e&&(e=new Te),new Ln(t,e)}!function(){function t(t,e){void 0===e&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,o=function(){return"person "+r++};this._labeledDescriptors=n.map((function(t){if(t instanceof q)return t;if(t instanceof Float32Array)return new q(o(),[t]);if(t.descriptor&&t.descriptor instanceof Float32Array)return new q(o(),[t.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")}))}Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(t,e){return e.map((function(e){return function(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map((function(t,e){return t-r[e]})).reduce((function(t,e){return t+Math.pow(e,2)}),0))}(e,t)})).reduce((function(t,e){return t+e}),0)/(e.length||1)},t.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map((function(n){var r=n.descriptors,o=n.label;return new H(o,e.computeMeanDistance(t,r))})).reduce((function(t,e){return t.distance<e.distance?t:e}))},t.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new H("unknown",e.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map((function(t){return t.toJSON()}))}},t.fromJSON=function(e){return new t(e.labeledDescriptors.map((function(t){return q.fromJSON(t)})),e.distanceThreshold)}}();var In=n("q1tI");function Fn(){var t,e="https://cdn.statically.io/gh/HiltonWS/hiltonws.github.io/master/smile/";function n(){return(n=c(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(In.useEffect)(c(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("inputVideo"),navigator.getUserMedia({video:{}},(function(t){return e.srcObject=t}),(function(t){return console.error(t)})),e.addEventListener("play",(function(){r()}));case 3:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function r(){return a.apply(this,arguments)}function a(){return(a=c(o.a.mark((function t(){var e,n,r,i,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=function(){i=setInterval(c(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Dn(e,r).withFaceExpressions();case 2:t.sent.forEach((function(t){t.expressions.happy>.9&&t.expressions.happy<=1?n.style.display="none":n.style.display="block"})),clearInterval(i),a();case 6:case"end":return t.stop()}}),t)}))),200)},e=document.getElementById("inputVideo"),(n=document.getElementById("overlay")).width=e.offsetWidth,n.height=e.offsetHeight,r=new Ye,i=0,n.style.borderStyle="dotted",a();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Promise.all([(t=e,un.tinyFaceDetector.load(t)),hn(e),ln(e),pn(e),fn(e)]).then(function(){return n.apply(this,arguments)}()).catch((function(t){return console.error(t)})),Object(i.jsxs)(d,{children:[Object(i.jsx)(u.a,{children:Object(i.jsx)("title",{children:"Smile"})}),Object(i.jsxs)("section",{className:m.a.headingMd,children:[Object(i.jsx)("h1",{children:"Smile"}),Object(i.jsx)("video",{id:"inputVideo",autoPlay:!0,muted:!0,children:" "}),Object(i.jsx)("canvas",{className:m.a.canvas,id:"overlay"})]})]})}},Ruhs:function(t,e,n){t.exports=n("XlSv")},Tred:function(t,e,n){t.exports={container:"layout_container__2t4v2",header:"layout_header__2rhWq",backTohome:"layout_backTohome__10oyl"}},XlSv:function(t,e,n){"use strict";n("lSNA");e.__esModule=!0,e.defaultHead=f,e.default=void 0;var r,o=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=r?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n("BqPY")),i=(r=n("t6Az"))&&r.__esModule?r:{default:r},a=n("x+CX"),c=n("kqoU"),s=n("cJU3");function u(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function f(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[o.default.createElement("meta",{charSet:"utf-8"})];return t||e.push(o.default.createElement("meta",{name:"viewport",content:"width=device-width"})),e}function h(t,e){return"string"===typeof e||"number"===typeof e?t:e.type===o.default.Fragment?t.concat(o.default.Children.toArray(e.props.children).reduce((function(t,e){return"string"===typeof e||"number"===typeof e?t:t.concat(e)}),[])):t.concat(e)}var p=["name","httpEquiv","charSet","itemProp"];function l(t,e){return t.reduce((function(t,e){var n=o.default.Children.toArray(e.props.children);return t.concat(n)}),[]).reduce(h,[]).reverse().concat(f(e.inAmpMode)).filter(function(){var t=new Set,e=new Set,n=new Set,r={};return function(o){var i=!0,a=!1;if(o.key&&"number"!==typeof o.key&&o.key.indexOf("$")>0){a=!0;var c=o.key.slice(o.key.indexOf("$")+1);t.has(c)?i=!1:t.add(c)}switch(o.type){case"title":case"base":e.has(o.type)?i=!1:e.add(o.type);break;case"meta":for(var s=0,u=p.length;s<u;s++){var f=p[s];if(o.props.hasOwnProperty(f))if("charSet"===f)n.has(f)?i=!1:n.add(f);else{var h=o.props[f],l=r[f]||new Set;"name"===f&&a||!l.has(h)?(l.add(h),r[f]=l):i=!1}}}return i}}()).reverse().map((function(t,e){var n=t.key||e;return o.default.cloneElement(t,{key:n})}))}function d(t){var e=t.children,n=(0,o.useContext)(a.AmpStateContext),r=(0,o.useContext)(c.HeadManagerContext);return o.default.createElement(i.default,{reduceComponentsToState:l,headManager:r,inAmpMode:(0,s.isInAmpMode)(n)},e)}d.rewind=function(){};var v=d;e.default=v},YC04:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n("mrSG"),o=n("7qA8");function i(){var e=t.Canvas||t.HTMLCanvasElement,n=t.Image||t.HTMLImageElement,i=t.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},a=Object(o.a)();return Object(r.a)({Canvas:e||function(){},CanvasRenderingContext2D:t.CanvasRenderingContext2D||function(){},Image:n||function(){},ImageData:t.ImageData||function(){},Video:t.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(n)return new n;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:i},a)}}).call(this,n("jzzT"))},Z4Yb:function(t,e,n){t.exports={heading2Xl:"utils_heading2Xl__1I65m",headingXl:"utils_headingXl__1XecN",headingLg:"utils_headingLg__de7p0",headingMd:"utils_headingMd__3de6G",borderCircle:"utils_borderCircle__13qdJ",colorInherit:"utils_colorInherit__3Gudf",padding1px:"utils_padding1px__oCny8",list:"utils_list__S7_pe",listItem:"utils_listItem__2eJpJ",lightText:"utils_lightText__12Ckm",canvas:"utils_canvas__1SWLi"}},ZLyF:function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,u=[],f=!1,h=-1;function p(){f&&s&&(f=!1,s.length?u=s.concat(u):h=-1,u.length&&l())}function l(){if(!f){var t=c(p);f=!0;for(var e=u.length;e;){for(s=u,u=[];++h<e;)s&&s[h].run();h=-1,e=u.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||f||c(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},a1gu:function(t,e,n){var r=n("cDf5"),o=n("PJYZ");t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!==typeof e?o(t):e}},cDf5:function(t,e){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},cJU3:function(t,e,n){"use strict";e.__esModule=!0,e.isInAmpMode=a,e.useAmp=function(){return a(o.default.useContext(i.AmpStateContext))};var r,o=(r=n("BqPY"))&&r.__esModule?r:{default:r},i=n("x+CX");function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.ampFirst,n=void 0!==e&&e,r=t.hybrid,o=void 0!==r&&r,i=t.hasQuery,a=void 0!==i&&i;return n||o&&a}},fssf:function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),a=r[0],c=r[1],s=new i(function(t,e,n){return 3*(e+n)/4-n}(0,a,c)),f=0,h=c>0?a-4:a;for(n=0;n<h;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],s[f++]=e>>16&255,s[f++]=e>>8&255,s[f++]=255&e;2===c&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,s[f++]=255&e);1===c&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,s[f++]=e>>8&255,s[f++]=255&e);return s},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=16383,c=0,s=n-o;c<s;c+=a)i.push(f(t,c,c+a>s?s:c+a));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,s=a.length;c<s;++c)r[c]=a[c],o[a.charCodeAt(c)]=c;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t,e,n){for(var o,i,a=[],c=e;c<n;c+=3)o=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(255&t[c+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},"jsv+":function(t,e){e.read=function(t,e,n,r,o){var i,a,c=8*o-r-1,s=(1<<c)-1,u=s>>1,f=-7,h=n?o-1:0,p=n?-1:1,l=t[e+h];for(h+=p,i=l&(1<<-f)-1,l>>=-f,f+=c;f>0;i=256*i+t[e+h],h+=p,f-=8);for(a=i&(1<<-f)-1,i>>=-f,f+=r;f>0;a=256*a+t[e+h],h+=p,f-=8);if(0===i)i=1-u;else{if(i===s)return a?NaN:1/0*(l?-1:1);a+=Math.pow(2,r),i-=u}return(l?-1:1)*a*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var a,c,s,u=8*i-o-1,f=(1<<u)-1,h=f>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:i-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-a))<1&&(a--,s*=2),(e+=a+h>=1?p/s:p*Math.pow(2,1-h))*s>=2&&(a++,s/=2),a+h>=f?(c=0,a=f):a+h>=1?(c=(e*s-1)*Math.pow(2,o),a+=h):(c=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;t[n+l]=255&c,l+=d,c/=256,o-=8);for(a=a<<o|c,u+=o;u>0;t[n+l]=255&a,l+=d,a/=256,u-=8);t[n+l-d]|=128*v}},jzzT:function(t,e){(function(e){t.exports=function(){var t={149:function(t){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(n){"object"===typeof window&&(e=window)}t.exports=e}},n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={exports:{}},i=!0;try{t[e](o,o.exports,r),i=!1}finally{i&&delete n[e]}return o.exports}return r.ab=e+"/",r(149)}()}).call(this,"/")},khMU:function(t,e,n){t.exports=n("ok9G")},kqoU:function(t,e,n){"use strict";var r;e.__esModule=!0,e.HeadManagerContext=void 0;var o=((r=n("BqPY"))&&r.__esModule?r:{default:r}).default.createContext({});e.HeadManagerContext=o},lFXY:function(t,e,n){t.exports=n("0W9y")},lSNA:function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},mrSG:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return s}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function a(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function c(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(c){i=[6,c],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}},ok9G:function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(L){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new T(r||[]);return i._invoke=function(t,e,n){var r=h;return function(o,i){if(r===l)throw new Error("Generator is already running");if(r===d){if("throw"===o)throw i;return A()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=E(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=l;var s=f(t,e,n);if("normal"===s.type){if(r=n.done?d:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=d,n.method="throw",n.arg=s.arg)}}}(t,n,a),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(L){return{type:"throw",arg:L}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",l="executing",d="completed",v={};function m(){}function b(){}function g(){}var y={};y[i]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(S([])));_&&_!==n&&r.call(_,i)&&(y=_);var x=g.prototype=m.prototype=Object.create(y);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,h=u.value;return h&&"object"===typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=f(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function S(t){if(t){var n=t[i];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:A}}function A(){return{value:e,done:!0}}return b.prototype=x.constructor=g,g.constructor=b,b.displayName=s(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},P(O.prototype),O.prototype[a]=function(){return this},t.AsyncIterator=O,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new O(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},P(x),s(x,c,"Generator"),x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;M(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:S(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=r}catch(o){Function("r","regeneratorRuntime = r")(r)}},q6vP:function(t,e,n){"use strict";(function(r,o){function i(){return"object"===typeof r&&"undefined"!==typeof t&&"undefined"!==typeof o&&!!o.version}n.d(e,"a",(function(){return i}))}).call(this,n("jzzT"),n("ZLyF"))},t6Az:function(t,e,n){"use strict";var r=n("RIqP"),o=n("lwsE"),i=n("W8MJ"),a=(n("PJYZ"),n("7W2i")),c=n("a1gu"),s=n("Nsbk");function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}e.__esModule=!0,e.default=void 0;var f=n("BqPY"),h=function(t){a(n,t);var e=u(n);function n(t){var i;return o(this,n),(i=e.call(this,t))._hasHeadManager=void 0,i.emitChange=function(){i._hasHeadManager&&i.props.headManager.updateHead(i.props.reduceComponentsToState(r(i.props.headManager.mountedInstances),i.props))},i._hasHeadManager=i.props.headManager&&i.props.headManager.mountedInstances,i}return i(n,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),n}(f.Component);e.default=h},"x+CX":function(t,e,n){"use strict";var r;e.__esModule=!0,e.AmpStateContext=void 0;var o=((r=n("BqPY"))&&r.__esModule?r:{default:r}).default.createContext({});e.AmpStateContext=o}},[["N6lM",0,1,3,2]]]);